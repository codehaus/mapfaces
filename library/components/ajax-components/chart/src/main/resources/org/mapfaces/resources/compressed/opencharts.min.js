var OpenCharts={singleFile:true};if(!window.OpenCharts){(function(){var singleFile=(typeof OpenCharts=="object"&&OpenCharts.singleFile);
window.OpenCharts={_scriptName:(!singleFile)?"OpenCharts/custom/OpenCharts.js":"OpenCharts.js",_getScriptLocation:function(){var scriptLocation="";
var scriptName=OpenCharts._scriptName;
var scripts=document.getElementsByTagName("script");
for(var i=0;
i<scripts.length;
i++){var src=scripts[i].getAttributeNS("http://www.w3.org/1999/xlink","href");
if(src){var index=src.lastIndexOf(scriptName);
var pathLength=-1;
if(pathLength<0){pathLength=src.length
}if((index>-1)&&(index+scriptName.length==pathLength)){scriptLocation=src.slice(0,pathLength-scriptName.length);
break
}}}return scriptLocation
}};
if(!singleFile){var jsfiles=new Array("OpenCharts/lib/OpenCharts/Util.js","OpenCharts/lib/OpenCharts/BaseTypes.js","OpenCharts/lib/OpenCharts/BaseTypes/Class.js","OpenCharts/lib/OpenCharts/BaseTypes/Bounds.js","OpenCharts/lib/OpenCharts/BaseTypes/Element.js","OpenCharts/lib/OpenCharts/BaseTypes/LonLat.js","OpenCharts/lib/OpenCharts/BaseTypes/Pixel.js","OpenCharts/lib/OpenCharts/BaseTypes/Size.js","OpenCharts/lib/OpenCharts/Ajax.js","OpenCharts/lib/OpenCharts/Request.js","OpenCharts/lib/OpenCharts/Request/XMLHttpRequest.js","OpenCharts/lib/OpenCharts/Events.js","OpenCharts/lib/OpenCharts/Map.js","OpenCharts/custom/OpenCharts/MapExt.js","OpenCharts/lib/OpenCharts/Handler.js","OpenCharts/lib/OpenCharts/Handler/Click.js","OpenCharts/lib/OpenCharts/Handler/Hover.js","OpenCharts/lib/OpenCharts/Handler/Drag.js","OpenCharts/lib/OpenCharts/Handler/Box.js","OpenCharts/lib/OpenCharts/Handler/MouseWheel.js","OpenCharts/lib/OpenCharts/Handler/Keyboard.js","OpenCharts/lib/OpenCharts/Control.js","OpenCharts/lib/OpenCharts/Geometry.js","OpenCharts/lib/OpenCharts/Geometry/Rectangle.js","OpenCharts/lib/OpenCharts/Geometry/Collection.js","OpenCharts/lib/OpenCharts/Geometry/Point.js","OpenCharts/lib/OpenCharts/Geometry/MultiPoint.js","OpenCharts/lib/OpenCharts/Geometry/Curve.js","OpenCharts/lib/OpenCharts/Geometry/LineString.js","OpenCharts/lib/OpenCharts/Geometry/LinearRing.js","OpenCharts/lib/OpenCharts/Geometry/Polygon.js","OpenCharts/lib/OpenCharts/Geometry/MultiLineString.js","OpenCharts/lib/OpenCharts/Geometry/MultiPolygon.js","OpenCharts/lib/OpenCharts/Geometry/Surface.js","OpenCharts/lib/OpenCharts/Renderer.js","OpenCharts/lib/OpenCharts/Renderer/Elements.js","OpenCharts/custom/OpenCharts/Renderer/ElementsExt.js","OpenCharts/lib/OpenCharts/Renderer/SVG.js","OpenCharts/custom/OpenCharts/Renderer/SVGExt.js","OpenCharts/lib/OpenCharts/Renderer/Canvas.js","OpenCharts/lib/OpenCharts/Renderer/VML.js","OpenCharts/custom/OpenCharts/Renderer/VMLExt.js","OpenCharts/custom/OpenCharts/Handler/MouseWheel.js","OpenCharts/custom/OpenCharts/Control/DragPan.js","OpenCharts/custom/OpenCharts/Control/ZoomBox.js","OpenCharts/custom/OpenCharts/Control/Navigation.js");
var agent=navigator.userAgent;
var docWrite=(agent.match("MSIE")||agent.match("Safari"));
if(docWrite){var allScriptTags=new Array(jsfiles.length)
}var host=OpenCharts._getScriptLocation();
for(var i=0;
i<jsfiles.length;
i++){if(docWrite){allScriptTags[i]="<script xlink:href='"+host+jsfiles[i]+"'><\/script>"
}else{var s=document.createElement("script");
s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",host+jsfiles[i]);
var h=document.getElementsByTagName("head").length?document.getElementsByTagName("head")[0]:document.body;
if(!h){h=document.documentElement
}h.appendChild(s)
}}if(docWrite){document.write(allScriptTags.join(""))
}}})();
OpenCharts.VERSION_NUMBER="$Revision: 7335 $"
};OpenCharts.Util={};
OpenCharts.Util.getElement=function(){var elements=[];
for(var i=0,len=arguments.length;
i<len;
i++){var element=arguments[i];
if(typeof element=="string"){element=document.getElementById(element)
}if(arguments.length==1){return element
}elements.push(element)
}return elements
};
OpenCharts.Util.extend=function(destination,source){destination=destination||{};
if(source){for(var property in source){var value=source[property];
if(value!==undefined){destination[property]=value
}}var sourceIsEvt=typeof window.Event=="function"&&source instanceof window.Event;
if(!sourceIsEvt&&source.hasOwnProperty&&source.hasOwnProperty("toString")){destination.toString=source.toString
}}return destination
};
OpenCharts.Util.removeItem=function(array,item){for(var i=array.length-1;
i>=0;
i--){if(array[i]==item){array.splice(i,1)
}}return array
};
OpenCharts.Util.clearArray=function(array){OpenCharts.Console.warn(OpenCharts.i18n("methodDeprecated",{newMethod:"array = []"}));
array.length=0
};
OpenCharts.Util.indexOf=function(array,obj){for(var i=0,len=array.length;
i<len;
i++){if(array[i]==obj){return i
}}return -1
};
OpenCharts.Util.modifyDOMElement=function(element,id,px,sz,position,border,overflow,opacity){if(id){element.id=id
}if(px){element.style.left=px.x+"px";
element.style.top=px.y+"px"
}if(sz){element.style.width=sz.w+"px";
element.style.height=sz.h+"px"
}if(position){element.style.position=position
}if(border){element.style.border=border
}if(overflow){element.style.overflow=overflow
}if(parseFloat(opacity)>=0&&parseFloat(opacity)<1){element.style.filter="alpha(opacity="+(opacity*100)+")";
element.style.opacity=opacity
}else{if(parseFloat(opacity)==1){element.style.filter="";
element.style.opacity=""
}}};
OpenCharts.Util.modifyDOMSVGRectElement=function(element,id,px,sz,position,border,overflow,opacity){if(id){element.setAttribute("id",id)
}if(px){element.setAttribute("x",px.x);
element.setAttribute("y",px.y)
}if(sz){element.setAttribute("width",sz.w);
element.setAttribute("height",sz.h)
}if(border){element.setAttribute("stroke",border);
if(border.stroke){element.setAttribute("stroke",border.stroke)
}if(border.width){element.setAttribute("stroke-width",border.width)
}}if(opacity){element.setAttribute("stroke-opacity",border.opacity);
element.setAttribute("fill-opacity",border.opacity)
}};
OpenCharts.Util.createDiv=function(id,px,sz,imgURL,position,border,overflow,opacity){var dom=document.createElement("div");
if(imgURL){dom.style.backgroundImage="url("+imgURL+")"
}if(!id){id=OpenCharts.Util.createUniqueID("OpenChartsDiv")
}if(!position){position="absolute"
}OpenCharts.Util.modifyDOMElement(dom,id,px,sz,position,border,overflow,opacity);
return dom
};
OpenCharts.Util.createRect=function(id,px,sz,imgURL,position,border,overflow,opacity){var dom=document.createElementNS("http://www.w3.org/2000/svg","rect");
if(imgURL){dom.style.backgroundImage="url("+imgURL+")"
}if(!id){id=OpenCharts.Util.createUniqueID("OpenChartsDiv")
}if(!position){position="absolute"
}dom.setAttributeNS(null,"shape-rendering","optimizeSpeed");
OpenCharts.Util.modifyDOMSVGRectElement(dom,id,px,sz,position,border,overflow,opacity);
return dom
};
OpenCharts.Util.createImage=function(id,px,sz,imgURL,position,border,opacity,delayDisplay){var image=document.createElement("img");
if(!id){id=OpenCharts.Util.createUniqueID("OpenChartsDiv")
}if(!position){position="relative"
}OpenCharts.Util.modifyDOMElement(image,id,px,sz,position,border,null,opacity);
if(delayDisplay){image.style.display="none";
OpenCharts.Event.observe(image,"load",OpenCharts.Function.bind(OpenCharts.Util.onImageLoad,image));
OpenCharts.Event.observe(image,"error",OpenCharts.Function.bind(OpenCharts.Util.onImageLoadError,image))
}image.style.alt=id;
image.galleryImg="no";
if(imgURL){image.src=imgURL
}return image
};
OpenCharts.Util.setOpacity=function(element,opacity){OpenCharts.Util.modifyDOMElement(element,null,null,null,null,null,null,opacity)
};
OpenCharts.Util.onImageLoad=function(){if(!this.viewRequestID||(this.map&&this.viewRequestID==this.map.viewRequestID)){this.style.backgroundColor=null;
this.style.display=""
}};
OpenCharts.Util.onImageLoadErrorColor="pink";
OpenCharts.IMAGE_RELOAD_ATTEMPTS=0;
OpenCharts.Util.onImageLoadError=function(){this._attempts=(this._attempts)?(this._attempts+1):1;
if(this._attempts<=OpenCharts.IMAGE_RELOAD_ATTEMPTS){var urls=this.urls;
if(urls&&urls instanceof Array&&urls.length>1){var src=this.src.toString();
var current_url,k;
for(k=0;
current_url=urls[k];
k++){if(src.indexOf(current_url)!=-1){break
}}var guess=Math.floor(urls.length*Math.random());
var new_url=urls[guess];
k=0;
while(new_url==current_url&&k++<4){guess=Math.floor(urls.length*Math.random());
new_url=urls[guess]
}this.src=src.replace(current_url,new_url)
}else{this.src=this.src
}}else{this.style.backgroundColor=OpenCharts.Util.onImageLoadErrorColor
}this.style.display=""
};
OpenCharts.Util.alphaHack=function(){var arVersion=navigator.appVersion.split("MSIE");
var version=parseFloat(arVersion[1]);
var filter=false;
try{filter=!!(document.body.filters)
}catch(e){}return(filter&&(version>=5.5)&&(version<7))
};
OpenCharts.Util.modifyAlphaImageDiv=function(div,id,px,sz,imgURL,position,border,sizing,opacity){OpenCharts.Util.modifyDOMElement(div,id,px,sz,position,null,null,opacity);
var img=div.childNodes[0];
if(imgURL){img.src=imgURL
}OpenCharts.Util.modifyDOMElement(img,div.id+"_innerImage",null,sz,"relative",border);
if(OpenCharts.Util.alphaHack()){if(div.style.display!="none"){div.style.display="inline-block"
}if(sizing==null){sizing="scale"
}div.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+img.src+"', sizingMethod='"+sizing+"')";
if(parseFloat(div.style.opacity)>=0&&parseFloat(div.style.opacity)<1){div.style.filter+=" alpha(opacity="+div.style.opacity*100+")"
}img.style.filter="alpha(opacity=0)"
}};
OpenCharts.Util.createAlphaImageDiv=function(id,px,sz,imgURL,position,border,sizing,opacity,delayDisplay){var div=OpenCharts.Util.createDiv();
var img=OpenCharts.Util.createImage(null,null,null,null,null,null,null,false);
div.appendChild(img);
if(delayDisplay){img.style.display="none";
OpenCharts.Event.observe(img,"load",OpenCharts.Function.bind(OpenCharts.Util.onImageLoad,div));
OpenCharts.Event.observe(img,"error",OpenCharts.Function.bind(OpenCharts.Util.onImageLoadError,div))
}OpenCharts.Util.modifyAlphaImageDiv(div,id,px,sz,imgURL,position,border,sizing,opacity);
return div
};
OpenCharts.Util.upperCaseObject=function(object){var uObject={};
for(var key in object){uObject[key.toUpperCase()]=object[key]
}return uObject
};
OpenCharts.Util.applyDefaults=function(to,from){to=to||{};
var fromIsEvt=typeof window.Event=="function"&&from instanceof window.Event;
for(var key in from){if(to[key]===undefined||(!fromIsEvt&&from.hasOwnProperty&&from.hasOwnProperty(key)&&!to.hasOwnProperty(key))){to[key]=from[key]
}}if(!fromIsEvt&&from&&from.hasOwnProperty&&from.hasOwnProperty("toString")&&!to.hasOwnProperty("toString")){to.toString=from.toString
}return to
};
OpenCharts.Util.getParameterString=function(params){var paramsArray=[];
for(var key in params){var value=params[key];
if((value!=null)&&(typeof value!="function")){var encodedValue;
if(typeof value=="object"&&value.constructor==Array){var encodedItemArray=[];
for(var itemIndex=0,len=value.length;
itemIndex<len;
itemIndex++){encodedItemArray.push(encodeURIComponent(value[itemIndex]))
}encodedValue=encodedItemArray.join(",")
}else{encodedValue=encodeURIComponent(value)
}paramsArray.push(encodeURIComponent(key)+"="+encodedValue)
}}return paramsArray.join("&")
};
OpenCharts.ImgPath="";
OpenCharts.Util.getImagesLocation=function(){return OpenCharts.ImgPath||(OpenCharts._getScriptLocation()+"img/")
};
OpenCharts.Util.Try=function(){var returnValue=null;
for(var i=0,len=arguments.length;
i<len;
i++){var lambda=arguments[i];
try{returnValue=lambda();
break
}catch(e){}}return returnValue
};
OpenCharts.Util.getNodes=function(p,tagName){var nodes=OpenCharts.Util.Try(function(){return OpenCharts.Util._getNodes(p.documentElement.childNodes,tagName)
},function(){return OpenCharts.Util._getNodes(p.childNodes,tagName)
});
return nodes
};
OpenCharts.Util._getNodes=function(nodes,tagName){var retArray=[];
for(var i=0,len=nodes.length;
i<len;
i++){if(nodes[i].nodeName==tagName){retArray.push(nodes[i])
}}return retArray
};
OpenCharts.Util.getTagText=function(parent,item,index){var result=OpenCharts.Util.getNodes(parent,item);
if(result&&(result.length>0)){if(!index){index=0
}if(result[index].childNodes.length>1){return result.childNodes[1].nodeValue
}else{if(result[index].childNodes.length==1){return result[index].firstChild.nodeValue
}}}else{return""
}};
OpenCharts.Util.getXmlNodeValue=function(node){var val=null;
OpenCharts.Util.Try(function(){val=node.text;
if(!val){val=node.textContent
}if(!val){val=node.firstChild.nodeValue
}},function(){val=node.textContent
});
return val
};
OpenCharts.Util.mouseLeft=function(evt,div){var target=(evt.relatedTarget)?evt.relatedTarget:evt.toElement;
while(target!=div&&target!=null){target=target.parentNode
}return(target!=div)
};
OpenCharts.Util.rad=function(x){return x*Math.PI/180
};
OpenCharts.Util.distVincenty=function(p1,p2){var a=6378137,b=6356752.3142,f=1/298.257223563;
var L=OpenCharts.Util.rad(p2.lon-p1.lon);
var U1=Math.atan((1-f)*Math.tan(OpenCharts.Util.rad(p1.lat)));
var U2=Math.atan((1-f)*Math.tan(OpenCharts.Util.rad(p2.lat)));
var sinU1=Math.sin(U1),cosU1=Math.cos(U1);
var sinU2=Math.sin(U2),cosU2=Math.cos(U2);
var lambda=L,lambdaP=2*Math.PI;
var iterLimit=20;
while(Math.abs(lambda-lambdaP)>1e-12&&--iterLimit>0){var sinLambda=Math.sin(lambda),cosLambda=Math.cos(lambda);
var sinSigma=Math.sqrt((cosU2*sinLambda)*(cosU2*sinLambda)+(cosU1*sinU2-sinU1*cosU2*cosLambda)*(cosU1*sinU2-sinU1*cosU2*cosLambda));
if(sinSigma==0){return 0
}var cosSigma=sinU1*sinU2+cosU1*cosU2*cosLambda;
var sigma=Math.atan2(sinSigma,cosSigma);
var alpha=Math.asin(cosU1*cosU2*sinLambda/sinSigma);
var cosSqAlpha=Math.cos(alpha)*Math.cos(alpha);
var cos2SigmaM=cosSigma-2*sinU1*sinU2/cosSqAlpha;
var C=f/16*cosSqAlpha*(4+f*(4-3*cosSqAlpha));
lambdaP=lambda;
lambda=L+(1-C)*f*Math.sin(alpha)*(sigma+C*sinSigma*(cos2SigmaM+C*cosSigma*(-1+2*cos2SigmaM*cos2SigmaM)))
}if(iterLimit==0){return NaN
}var uSq=cosSqAlpha*(a*a-b*b)/(b*b);
var A=1+uSq/16384*(4096+uSq*(-768+uSq*(320-175*uSq)));
var B=uSq/1024*(256+uSq*(-128+uSq*(74-47*uSq)));
var deltaSigma=B*sinSigma*(cos2SigmaM+B/4*(cosSigma*(-1+2*cos2SigmaM*cos2SigmaM)-B/6*cos2SigmaM*(-3+4*sinSigma*sinSigma)*(-3+4*cos2SigmaM*cos2SigmaM)));
var s=b*A*(sigma-deltaSigma);
var d=s.toFixed(3)/1000;
return d
};
OpenCharts.Util.getParameters=function(url){url=url||window.location.href;
var paramsString="";
if(OpenCharts.String.contains(url,"?")){var start=url.indexOf("?")+1;
var end=OpenCharts.String.contains(url,"#")?url.indexOf("#"):url.length;
paramsString=url.substring(start,end)
}var parameters={};
var pairs=paramsString.split(/[&;]/);
for(var i=0,len=pairs.length;
i<len;
++i){var keyValue=pairs[i].split("=");
if(keyValue[0]){var key=decodeURIComponent(keyValue[0]);
var value=keyValue[1]||"";
value=value.split(",");
for(var j=0,jlen=value.length;
j<jlen;
j++){value[j]=decodeURIComponent(value[j])
}if(value.length==1){value=value[0]
}parameters[key]=value
}}return parameters
};
OpenCharts.Util.getArgs=function(url){OpenCharts.Console.warn(OpenCharts.i18n("methodDeprecated",{newMethod:"OpenCharts.Util.getParameters"}));
return OpenCharts.Util.getParameters(url)
};
OpenCharts.Util.lastSeqID=0;
OpenCharts.Util.createUniqueID=function(prefix){if(prefix==null){prefix="id_"
}OpenCharts.Util.lastSeqID+=1;
return prefix+OpenCharts.Util.lastSeqID
};
OpenCharts.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};
OpenCharts.INCHES_PER_UNIT["in"]=OpenCharts.INCHES_PER_UNIT.inches;
OpenCharts.INCHES_PER_UNIT.degrees=OpenCharts.INCHES_PER_UNIT.dd;
OpenCharts.INCHES_PER_UNIT.nmi=1852*OpenCharts.INCHES_PER_UNIT.m;
OpenCharts.DOTS_PER_INCH=72;
OpenCharts.Util.normalizeScale=function(scale){var normScale=(scale>1)?(1/scale):scale;
return normScale
};
OpenCharts.Util.getResolutionFromScale=function(scale,units){if(units==null){units="degrees"
}var normScale=OpenCharts.Util.normalizeScale(scale);
var resolution=1/(normScale*OpenCharts.INCHES_PER_UNIT[units]*OpenCharts.DOTS_PER_INCH);
return resolution
};
OpenCharts.Util.getScaleFromResolution=function(resolution,units){if(units==null){units="degrees"
}var scale=resolution*OpenCharts.INCHES_PER_UNIT[units]*OpenCharts.DOTS_PER_INCH;
return scale
};
OpenCharts.Util.safeStopPropagation=function(evt){OpenCharts.Event.stop(evt,true)
};
OpenCharts.Util.pagePosition=function(forElement){var valueT=0,valueL=0;
var element=forElement;
var child=forElement;
while(element){if(element==document.body){if(OpenCharts.Element.getStyle(child,"position")=="absolute"){break
}}valueT+=element.offsetTop||0;
valueL+=element.offsetLeft||0;
child=element;
try{element=element.offsetParent
}catch(e){OpenCharts.Console.error(OpenCharts.i18n("pagePositionFailed",{elemId:element.id}));
break
}}element=forElement;
while(element){valueT-=element.scrollTop||0;
valueL-=element.scrollLeft||0;
element=element.parentNode
}return[valueL,valueT]
};
OpenCharts.Util.isEquivalentUrl=function(url1,url2,options){options=options||{};
OpenCharts.Util.applyDefaults(options,{ignoreCase:true,ignorePort80:true,ignoreHash:true});
var urlObj1=OpenCharts.Util.createUrlObject(url1,options);
var urlObj2=OpenCharts.Util.createUrlObject(url2,options);
for(var key in urlObj1){if(options.test){OpenCharts.Console.userError(key+"\n1:"+urlObj1[key]+"\n2:"+urlObj2[key])
}var val1=urlObj1[key];
var val2=urlObj2[key];
switch(key){case"args":break;
case"host":case"port":case"protocol":if((val1=="")||(val2=="")){break
}default:if((key!="args")&&(urlObj1[key]!=urlObj2[key])){return false
}break
}}for(var key in urlObj1.args){if(urlObj1.args[key]!=urlObj2.args[key]){return false
}delete urlObj2.args[key]
}for(var key in urlObj2.args){return false
}return true
};
OpenCharts.Util.createUrlObject=function(url,options){options=options||{};
var urlObject={};
if(options.ignoreCase){url=url.toLowerCase()
}var a=document.createElement("a");
a.href=url;
urlObject.host=a.host;
var port=a.port;
if(port.length<=0){var newHostLength=urlObject.host.length-(port.length);
urlObject.host=urlObject.host.substring(0,newHostLength)
}urlObject.protocol=a.protocol;
urlObject.port=((port=="80")&&(options.ignorePort80))?"":port;
urlObject.hash=(options.ignoreHash)?"":a.hash;
var queryString=a.search;
if(!queryString){var qMark=url.indexOf("?");
queryString=(qMark!=-1)?url.substr(qMark):""
}urlObject.args=OpenCharts.Util.getParameters(queryString);
if(((urlObject.protocol=="file:")&&(url.indexOf("file:")!=-1))||((urlObject.protocol!="file:")&&(urlObject.host!=""))){urlObject.pathname=a.pathname;
var qIndex=urlObject.pathname.indexOf("?");
if(qIndex!=-1){urlObject.pathname=urlObject.pathname.substring(0,qIndex)
}}else{var relStr=OpenCharts.Util.removeTail(url);
var backs=0;
do{var index=relStr.indexOf("../");
if(index==0){backs++;
relStr=relStr.substr(3)
}else{if(index>=0){var prevChunk=relStr.substr(0,index-1);
var slash=prevChunk.indexOf("/");
prevChunk=(slash!=-1)?prevChunk.substr(0,slash+1):"";
var postChunk=relStr.substr(index+3);
relStr=prevChunk+postChunk
}}}while(index!=-1);
var windowAnchor=document.createElement("a");
var windowUrl=window.location.href;
if(options.ignoreCase){windowUrl=windowUrl.toLowerCase()
}windowAnchor.href=windowUrl;
urlObject.protocol=windowAnchor.protocol;
var splitter=(windowAnchor.pathname.indexOf("/")!=-1)?"/":"\\";
var dirs=windowAnchor.pathname.split(splitter);
dirs.pop();
while((backs>0)&&(dirs.length>0)){dirs.pop();
backs--
}relStr=dirs.join("/")+"/"+relStr;
urlObject.pathname=relStr
}if((urlObject.protocol=="file:")||(urlObject.protocol=="")){urlObject.host="localhost"
}return urlObject
};
OpenCharts.Util.removeTail=function(url){var head=null;
var qMark=url.indexOf("?");
var hashMark=url.indexOf("#");
if(qMark==-1){head=(hashMark!=-1)?url.substr(0,hashMark):url
}else{head=(hashMark!=-1)?url.substr(0,Math.min(qMark,hashMark)):url.substr(0,qMark)
}return head
};
OpenCharts.Util.getBrowserName=function(){var browserName="";
var ua=navigator.userAgent.toLowerCase();
if(ua.indexOf("opera")!=-1){browserName="opera"
}else{if(ua.indexOf("msie")!=-1){browserName="msie"
}else{if(ua.indexOf("safari")!=-1){browserName="safari"
}else{if(ua.indexOf("mozilla")!=-1){if(ua.indexOf("firefox")!=-1){browserName="firefox"
}else{browserName="mozilla"
}}}}}return browserName
};
OpenCharts.Util.getRenderedDimensions=function(contentHTML,size,options){var w,h;
var container=document.createElement("div");
container.style.overflow="";
container.style.position="absolute";
container.style.left="-9999px";
if(size){if(size.w){w=size.w;
container.style.width=w+"px"
}else{if(size.h){h=size.h;
container.style.height=h+"px"
}}}if(options&&options.displayClass){container.className=options.displayClass
}var content=document.createElement("div");
content.innerHTML=contentHTML;
container.appendChild(content);
document.body.appendChild(container);
if(!w){w=parseInt(content.scrollWidth);
container.style.width=w+"px"
}if(!h){h=parseInt(content.scrollHeight)
}container.removeChild(content);
document.body.removeChild(container);
return new OpenCharts.Size(w,h)
};
OpenCharts.Util.getScrollbarWidth=function(){var scrollbarWidth=OpenCharts.Util._scrollbarWidth;
if(scrollbarWidth==null){var scr=null;
var inn=null;
var wNoScroll=0;
var wScroll=0;
scr=document.createElement("div");
scr.style.position="absolute";
scr.style.top="-1000px";
scr.style.left="-1000px";
scr.style.width="100px";
scr.style.height="50px";
scr.style.overflow="hidden";
inn=document.createElement("div");
inn.style.width="100%";
inn.style.height="200px";
scr.appendChild(inn);
document.body.appendChild(scr);
wNoScroll=inn.offsetWidth;
scr.style.overflow="scroll";
wScroll=inn.offsetWidth;
document.body.removeChild(document.body.lastChild);
OpenCharts.Util._scrollbarWidth=(wNoScroll-wScroll);
scrollbarWidth=OpenCharts.Util._scrollbarWidth
}return scrollbarWidth
};
OpenCharts.Util.getScreenCTM=function(){var root=document.documentElement;
var sCTM=root.createSVGMatrix();
var tr=root.createSVGMatrix();
var par=root.getAttributeNS(null,"preserveAspectRatio");
if(!par){par="xMidYMid meet"
}parX=par.substring(0,4);
parY=par.substring(4,8);
ma=par.split(" ");
mos=ma[1];
sCTM.a=1;
sCTM.d=1;
sCTM.e=0;
sCTM.f=0;
w=root.getAttribute("width")||"100%";
h=root.getAttribute("height")||"100%";
if(w.indexOf("%")+1){w=(parseFloat(w)/100)*innerWidth
}if(h.indexOf("%")+1){h=(parseFloat(h)/100)*innerHeight
}var vb=(root.getAttribute("viewBox")||"0 0 "+w+" "+h).split(" ");
tr.a=root.currentScale;
tr.d=root.currentScale;
tr.e=root.currentTranslate.x;
tr.f=root.currentTranslate.y;
sx=w/vb[2];
sy=h/vb[3];
if(mos=="slice"){s=(sx>sy?sx:sy)
}else{s=(sx<sy?sx:sy)
}if(par=="none"){sCTM.a=sx;
sCTM.d=sy;
sCTM.e=-vb[0]*sx;
sCTM.f=-vb[0]*sy;
sCTM=tr.multiply(sCTM)
}else{sCTM.a=s;
sCTM.d=s;
switch(parX){case"xMid":sCTM.e=((w-vb[2]*s)/2)-vb[0]*s;
break;
case"xMin":sCTM.e=-vb[0]*s;
break;
case"xMax":sCTM.e=(w-vb[2]*s)-vb[0]*s;
break
}switch(parY){case"YMid":sCTM.f=(h-vb[3]*s)/2-vb[1]*s;
break;
case"YMin":sCTM.f=-vb[1]*s;
break;
case"YMax":sCTM.f=(h-vb[3]*s)-vb[1]*s;
break
}sCTM=tr.multiply(sCTM)
}return sCTM
};OpenCharts.String={startsWith:function(str,sub){return(str.indexOf(sub)==0)
},contains:function(str,sub){return(str.indexOf(sub)!=-1)
},trim:function(str){return str.replace(/^\s*(.*?)\s*$/,"$1")
},camelize:function(str){var oStringList=str.split("-");
var camelizedString=oStringList[0];
for(var i=1,len=oStringList.length;
i<len;
i++){var s=oStringList[i];
camelizedString+=s.charAt(0).toUpperCase()+s.substring(1)
}return camelizedString
},format:function(template,context,args){if(!context){context=window
}var tokens=template.split("${");
var item,last,replacement;
for(var i=1,len=tokens.length;
i<len;
i++){item=tokens[i];
last=item.indexOf("}");
if(last>0){replacement=context[item.substring(0,last)];
if(typeof replacement=="function"){replacement=args?replacement.apply(null,args):replacement()
}tokens[i]=replacement+item.substring(++last)
}else{tokens[i]="${"+item
}}return tokens.join("")
},numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(value){return OpenCharts.String.numberRegEx.test(value)
}};
if(!String.prototype.startsWith){String.prototype.startsWith=function(sStart){OpenCharts.Console.warn(OpenCharts.i18n("methodDeprecated",{newMethod:"OpenCharts.String.startsWith"}));
return OpenCharts.String.startsWith(this,sStart)
}
}if(!String.prototype.contains){String.prototype.contains=function(str){OpenCharts.Console.warn(OpenCharts.i18n("methodDeprecated",{newMethod:"OpenCharts.String.contains"}));
return OpenCharts.String.contains(this,str)
}
}if(!String.prototype.trim){String.prototype.trim=function(){OpenCharts.Console.warn(OpenCharts.i18n("methodDeprecated",{newMethod:"OpenCharts.String.trim"}));
return OpenCharts.String.trim(this)
}
}if(!String.prototype.camelize){String.prototype.camelize=function(){OpenCharts.Console.warn(OpenCharts.i18n("methodDeprecated",{newMethod:"OpenCharts.String.camelize"}));
return OpenCharts.String.camelize(this)
}
}OpenCharts.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(num,sig){var fig=0;
if(sig>0){fig=parseFloat(num.toPrecision(sig))
}return fig
},format:function(num,dec,tsep,dsep){dec=(typeof dec!="undefined")?dec:0;
tsep=(typeof tsep!="undefined")?tsep:OpenCharts.Number.thousandsSeparator;
dsep=(typeof dsep!="undefined")?dsep:OpenCharts.Number.decimalSeparator;
if(dec!=null){num=parseFloat(num.toFixed(dec))
}var parts=num.toString().split(".");
if(parts.length==1&&dec==null){dec=0
}var integer=parts[0];
if(tsep){var thousands=/(-?[0-9]+)([0-9]{3})/;
while(thousands.test(integer)){integer=integer.replace(thousands,"$1"+tsep+"$2")
}}var str;
if(dec==0){str=integer
}else{var rem=parts.length>1?parts[1]:"0";
if(dec!=null){rem=rem+new Array(dec-rem.length+1).join("0")
}str=integer+dsep+rem
}return str
}};
if(!Number.prototype.limitSigDigs){Number.prototype.limitSigDigs=function(sig){OpenCharts.Console.warn(OpenCharts.i18n("methodDeprecated",{newMethod:"OpenCharts.Number.limitSigDigs"}));
return OpenCharts.Number.limitSigDigs(this,sig)
}
}OpenCharts.Function={bind:function(func,object){var args=Array.prototype.slice.apply(arguments,[2]);
return function(){var newArgs=args.concat(Array.prototype.slice.apply(arguments,[0]));
return func.apply(object,newArgs)
}
},bindAsEventListener:function(func,object){return function(event){return func.call(object,event||window.event)
}
}};
if(!Function.prototype.bind){Function.prototype.bind=function(){OpenCharts.Console.warn(OpenCharts.i18n("methodDeprecated",{newMethod:"OpenCharts.Function.bind"}));
Array.prototype.unshift.apply(arguments,[this]);
return OpenCharts.Function.bind.apply(null,arguments)
}
}if(!Function.prototype.bindAsEventListener){Function.prototype.bindAsEventListener=function(object){OpenCharts.Console.warn(OpenCharts.i18n("methodDeprecated",{newMethod:"OpenCharts.Function.bindAsEventListener"}));
return OpenCharts.Function.bindAsEventListener(this,object)
}
}OpenCharts.Array={filter:function(array,callback,caller){var selected=[];
if(Array.prototype.filter){selected=array.filter(callback,caller)
}else{var len=array.length;
if(typeof callback!="function"){throw new TypeError()
}for(var i=0;
i<len;
i++){if(i in array){var val=array[i];
if(callback.call(caller,val,i,array)){selected.push(val)
}}}}return selected
}};OpenCharts.Class=function(){var Class=function(){if(arguments&&arguments[0]!=OpenCharts.Class.isPrototype){this.initialize.apply(this,arguments)
}};
var extended={};
var parent;
for(var i=0,len=arguments.length;
i<len;
++i){if(typeof arguments[i]=="function"){parent=arguments[i].prototype
}else{parent=arguments[i]
}OpenCharts.Util.extend(extended,parent)
}Class.prototype=extended;
return Class
};
OpenCharts.Class.isPrototype=function(){};
OpenCharts.Class.create=function(){return function(){if(arguments&&arguments[0]!=OpenCharts.Class.isPrototype){this.initialize.apply(this,arguments)
}}
};
OpenCharts.Class.inherit=function(){var superClass=arguments[0];
var proto=new superClass(OpenCharts.Class.isPrototype);
for(var i=1,len=arguments.length;
i<len;
i++){if(typeof arguments[i]=="function"){var mixin=arguments[i];
arguments[i]=new mixin(OpenCharts.Class.isPrototype)
}OpenCharts.Util.extend(proto,arguments[i])
}return proto
};OpenCharts.Bounds=OpenCharts.Class({left:null,bottom:null,right:null,top:null,initialize:function(left,bottom,right,top){if(left!=null){this.left=parseFloat(left)
}if(bottom!=null){this.bottom=parseFloat(bottom)
}if(right!=null){this.right=parseFloat(right)
}if(top!=null){this.top=parseFloat(top)
}},clone:function(){return new OpenCharts.Bounds(this.left,this.bottom,this.right,this.top)
},equals:function(bounds){var equals=false;
if(bounds!=null){equals=((this.left==bounds.left)&&(this.right==bounds.right)&&(this.top==bounds.top)&&(this.bottom==bounds.bottom))
}return equals
},toString:function(){return("left-bottom=("+this.left+","+this.bottom+") right-top=("+this.right+","+this.top+")")
},toArray:function(){return[this.left,this.bottom,this.right,this.top]
},toBBOX:function(decimal){if(decimal==null){decimal=6
}var mult=Math.pow(10,decimal);
var bbox=Math.round(this.left*mult)/mult+","+Math.round(this.bottom*mult)/mult+","+Math.round(this.right*mult)/mult+","+Math.round(this.top*mult)/mult;
return bbox
},toGeometry:function(){return new OpenCharts.Geometry.Polygon([new OpenCharts.Geometry.LinearRing([new OpenCharts.Geometry.Point(this.left,this.bottom),new OpenCharts.Geometry.Point(this.right,this.bottom),new OpenCharts.Geometry.Point(this.right,this.top),new OpenCharts.Geometry.Point(this.left,this.top)])])
},getWidth:function(){return(this.right-this.left)
},getHeight:function(){return(this.top-this.bottom)
},getSize:function(){return new OpenCharts.Size(this.getWidth(),this.getHeight())
},getCenterPixel:function(){return new OpenCharts.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)
},getCenterLonLat:function(){return new OpenCharts.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2)
},scale:function(ratio,origin){if(origin==null){origin=this.getCenterLonLat()
}var bounds=[];
var origx,origy;
if(origin.CLASS_NAME=="OpenCharts.LonLat"){origx=origin.lon;
origy=origin.lat
}else{origx=origin.x;
origy=origin.y
}var left=(this.left-origx)*ratio+origx;
var bottom=(this.bottom-origy)*ratio+origy;
var right=(this.right-origx)*ratio+origx;
var top=(this.top-origy)*ratio+origy;
return new OpenCharts.Bounds(left,bottom,right,top)
},add:function(x,y){if((x==null)||(y==null)){var msg=OpenCharts.i18n("boundsAddError");
OpenCharts.Console.error(msg);
return null
}return new OpenCharts.Bounds(this.left+x,this.bottom+y,this.right+x,this.top+y)
},extend:function(object){var bounds=null;
if(object){switch(object.CLASS_NAME){case"OpenCharts.LonLat":bounds=new OpenCharts.Bounds(object.lon,object.lat,object.lon,object.lat);
break;
case"OpenCharts.Geometry.Point":bounds=new OpenCharts.Bounds(object.x,object.y,object.x,object.y);
break;
case"OpenCharts.Bounds":bounds=object;
break
}if(bounds){if((this.left==null)||(bounds.left<this.left)){this.left=bounds.left
}if((this.bottom==null)||(bounds.bottom<this.bottom)){this.bottom=bounds.bottom
}if((this.right==null)||(bounds.right>this.right)){this.right=bounds.right
}if((this.top==null)||(bounds.top>this.top)){this.top=bounds.top
}}}},containsLonLat:function(ll,inclusive){return this.contains(ll.lon,ll.lat,inclusive)
},containsPixel:function(px,inclusive){return this.contains(px.x,px.y,inclusive)
},contains:function(x,y,inclusive){if(inclusive==null){inclusive=true
}var contains=false;
if(inclusive){contains=((x>=this.left)&&(x<=this.right)&&(y>=this.bottom)&&(y<=this.top))
}else{contains=((x>this.left)&&(x<this.right)&&(y>this.bottom)&&(y<this.top))
}return contains
},intersectsBounds:function(bounds,inclusive){if(inclusive==null){inclusive=true
}var inBottom=(bounds.bottom==this.bottom&&bounds.top==this.top)?true:(((bounds.bottom>this.bottom)&&(bounds.bottom<this.top))||((this.bottom>bounds.bottom)&&(this.bottom<bounds.top)));
var inTop=(bounds.bottom==this.bottom&&bounds.top==this.top)?true:(((bounds.top>this.bottom)&&(bounds.top<this.top))||((this.top>bounds.bottom)&&(this.top<bounds.top)));
var inRight=(bounds.right==this.right&&bounds.left==this.left)?true:(((bounds.right>this.left)&&(bounds.right<this.right))||((this.right>bounds.left)&&(this.right<bounds.right)));
var inLeft=(bounds.right==this.right&&bounds.left==this.left)?true:(((bounds.left>this.left)&&(bounds.left<this.right))||((this.left>bounds.left)&&(this.left<bounds.right)));
return(this.containsBounds(bounds,true,inclusive)||bounds.containsBounds(this,true,inclusive)||((inTop||inBottom)&&(inLeft||inRight)))
},containsBounds:function(bounds,partial,inclusive){if(partial==null){partial=false
}if(inclusive==null){inclusive=true
}var inLeft;
var inTop;
var inRight;
var inBottom;
if(inclusive){inLeft=(bounds.left>=this.left)&&(bounds.left<=this.right);
inTop=(bounds.top>=this.bottom)&&(bounds.top<=this.top);
inRight=(bounds.right>=this.left)&&(bounds.right<=this.right);
inBottom=(bounds.bottom>=this.bottom)&&(bounds.bottom<=this.top)
}else{inLeft=(bounds.left>this.left)&&(bounds.left<this.right);
inTop=(bounds.top>this.bottom)&&(bounds.top<this.top);
inRight=(bounds.right>this.left)&&(bounds.right<this.right);
inBottom=(bounds.bottom>this.bottom)&&(bounds.bottom<this.top)
}return(partial)?(inTop||inBottom)&&(inLeft||inRight):(inTop&&inLeft&&inBottom&&inRight)
},determineQuadrant:function(lonlat){var quadrant="";
var center=this.getCenterLonLat();
quadrant+=(lonlat.lat<center.lat)?"b":"t";
quadrant+=(lonlat.lon<center.lon)?"l":"r";
return quadrant
},transform:function(source,dest){var ll=OpenCharts.Projection.transform({x:this.left,y:this.bottom},source,dest);
var lr=OpenCharts.Projection.transform({x:this.right,y:this.bottom},source,dest);
var ul=OpenCharts.Projection.transform({x:this.left,y:this.top},source,dest);
var ur=OpenCharts.Projection.transform({x:this.right,y:this.top},source,dest);
this.left=Math.min(ll.x,ul.x);
this.bottom=Math.min(ll.y,lr.y);
this.right=Math.max(lr.x,ur.x);
this.top=Math.max(ul.y,ur.y);
return this
},wrapDateLine:function(maxExtent,options){options=options||{};
var leftTolerance=options.leftTolerance||0;
var rightTolerance=options.rightTolerance||0;
var newBounds=this.clone();
if(maxExtent){while(newBounds.left<maxExtent.left&&(newBounds.right-rightTolerance)<=maxExtent.left){newBounds=newBounds.add(maxExtent.getWidth(),0)
}while((newBounds.left+leftTolerance)>=maxExtent.right&&newBounds.right>maxExtent.right){newBounds=newBounds.add(-maxExtent.getWidth(),0)
}}return newBounds
},CLASS_NAME:"OpenCharts.Bounds"});
OpenCharts.Bounds.fromString=function(str){var bounds=str.split(",");
return OpenCharts.Bounds.fromArray(bounds)
};
OpenCharts.Bounds.fromArray=function(bbox){return new OpenCharts.Bounds(parseFloat(bbox[0]),parseFloat(bbox[1]),parseFloat(bbox[2]),parseFloat(bbox[3]))
};
OpenCharts.Bounds.fromSize=function(size){return new OpenCharts.Bounds(0,size.h,size.w,0)
};
OpenCharts.Bounds.oppositeQuadrant=function(quadrant){var opp="";
opp+=(quadrant.charAt(0)=="t")?"b":"t";
opp+=(quadrant.charAt(1)=="l")?"r":"l";
return opp
};OpenCharts.Element={visible:function(element){return OpenCharts.Util.getElement(element).style.display!="none"
},toggle:function(){for(var i=0,len=arguments.length;
i<len;
i++){var element=OpenCharts.Util.getElement(arguments[i]);
var display=OpenCharts.Element.visible(element)?"hide":"show";
OpenCharts.Element[display](element)
}},hide:function(){for(var i=0,len=arguments.length;
i<len;
i++){var element=OpenCharts.Util.getElement(arguments[i]);
element.style.display="none"
}},show:function(){for(var i=0,len=arguments.length;
i<len;
i++){var element=OpenCharts.Util.getElement(arguments[i]);
element.style.display=""
}},remove:function(element){element=OpenCharts.Util.getElement(element);
element.parentNode.removeChild(element)
},getHeight:function(element){element=OpenCharts.Util.getElement(element);
return element.offsetHeight
},getDimensions:function(element){element=OpenCharts.Util.getElement(element);
if(OpenCharts.Element.getStyle(element,"display")!="none"){return{width:element.offsetWidth,height:element.offsetHeight}
}var els=element.style;
var originalVisibility=els.visibility;
var originalPosition=els.position;
els.visibility="hidden";
els.position="absolute";
els.display="";
var originalWidth=element.clientWidth;
var originalHeight=element.clientHeight;
els.display="none";
els.position=originalPosition;
els.visibility=originalVisibility;
return{width:originalWidth,height:originalHeight}
},hasClass:function(element,name){var names=element.className;
return(!!names&&new RegExp("(^|\\s)"+name+"(\\s|$)").test(names))
},addClass:function(element,name){if(!OpenCharts.Element.hasClass(element,name)){element.className+=(element.className?" ":"")+name
}return element
},removeClass:function(element,name){var names=element.className;
if(names){element.className=OpenCharts.String.trim(names.replace(new RegExp("(^|\\s+)"+name+"(\\s+|$)")," "))
}return element
},toggleClass:function(element,name){if(OpenCharts.Element.hasClass(element,name)){OpenCharts.Element.removeClass(element,name)
}else{OpenCharts.Element.addClass(element,name)
}return element
},getStyle:function(element,style){element=OpenCharts.Util.getElement(element);
var value=null;
if(element&&element.style){value=element.style[OpenCharts.String.camelize(style)];
if(!value){if(document.defaultView&&document.defaultView.getComputedStyle){var css=document.defaultView.getComputedStyle(element,null);
value=css?css.getPropertyValue(style):null
}else{if(element.currentStyle){value=element.currentStyle[OpenCharts.String.camelize(style)]
}}}var positions=["left","top","right","bottom"];
if(window.opera&&(OpenCharts.Util.indexOf(positions,style)!=-1)&&(OpenCharts.Element.getStyle(element,"position")=="static")){value="auto"
}}return value=="auto"?null:value
}};OpenCharts.LonLat=OpenCharts.Class({lon:0,lat:0,initialize:function(lon,lat){this.lon=parseFloat(lon);
this.lat=parseFloat(lat)
},toString:function(){return("lon="+this.lon+",lat="+this.lat)
},toShortString:function(){return(this.lon+", "+this.lat)
},clone:function(){return new OpenCharts.LonLat(this.lon,this.lat)
},add:function(lon,lat){if((lon==null)||(lat==null)){var msg=OpenCharts.i18n("lonlatAddError");
OpenCharts.Console.error(msg);
return null
}return new OpenCharts.LonLat(this.lon+lon,this.lat+lat)
},equals:function(ll){var equals=false;
if(ll!=null){equals=((this.lon==ll.lon&&this.lat==ll.lat)||(isNaN(this.lon)&&isNaN(this.lat)&&isNaN(ll.lon)&&isNaN(ll.lat)))
}return equals
},transform:function(source,dest){var point=OpenCharts.Projection.transform({x:this.lon,y:this.lat},source,dest);
this.lon=point.x;
this.lat=point.y;
return this
},wrapDateLine:function(maxExtent){var newLonLat=this.clone();
if(maxExtent){while(newLonLat.lon<maxExtent.left){newLonLat.lon+=maxExtent.getWidth()
}while(newLonLat.lon>maxExtent.right){newLonLat.lon-=maxExtent.getWidth()
}}return newLonLat
},CLASS_NAME:"OpenCharts.LonLat"});
OpenCharts.LonLat.fromString=function(str){var pair=str.split(",");
return new OpenCharts.LonLat(parseFloat(pair[0]),parseFloat(pair[1]))
};OpenCharts.Pixel=OpenCharts.Class({x:0,y:0,initialize:function(x,y){this.x=parseFloat(x);
this.y=parseFloat(y)
},toString:function(){return("x="+this.x+",y="+this.y)
},clone:function(){return new OpenCharts.Pixel(this.x,this.y)
},equals:function(px){var equals=false;
if(px!=null){equals=((this.x==px.x&&this.y==px.y)||(isNaN(this.x)&&isNaN(this.y)&&isNaN(px.x)&&isNaN(px.y)))
}return equals
},add:function(x,y){if((x==null)||(y==null)){var msg=OpenCharts.i18n("pixelAddError");
OpenCharts.Console.error(msg);
return null
}return new OpenCharts.Pixel(this.x+x,this.y+y)
},offset:function(px){var newPx=this.clone();
if(px){newPx=this.add(px.x,px.y)
}return newPx
},CLASS_NAME:"OpenCharts.Pixel"});OpenCharts.Size=OpenCharts.Class({w:0,h:0,initialize:function(w,h){this.w=parseFloat(w);
this.h=parseFloat(h)
},toString:function(){return("w="+this.w+",h="+this.h)
},clone:function(){return new OpenCharts.Size(this.w,this.h)
},equals:function(sz){var equals=false;
if(sz!=null){equals=((this.w==sz.w&&this.h==sz.h)||(isNaN(this.w)&&isNaN(this.h)&&isNaN(sz.w)&&isNaN(sz.h)))
}return equals
},CLASS_NAME:"OpenCharts.Size"});OpenCharts.Event={observers:false,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(event){return event.target||event.srcElement
},isLeftClick:function(event){return(((event.which)&&(event.which==1))||((event.button)&&(event.button==1)))
},isRightClick:function(event){return(((event.which)&&(event.which==3))||((event.button)&&(event.button==2)))
},stop:function(event,allowDefault){if(!allowDefault){if(event.preventDefault){event.preventDefault()
}else{event.returnValue=false
}}if(event.stopPropagation){event.stopPropagation()
}else{event.cancelBubble=true
}},findElement:function(event,tagName){var element=OpenCharts.Event.element(event);
while(element.parentNode&&(!element.tagName||(element.tagName.toUpperCase()!=tagName.toUpperCase()))){element=element.parentNode
}return element
},observe:function(elementParam,name,observer,useCapture){var element=OpenCharts.Util.getElement(elementParam);
useCapture=useCapture||false;
if(name=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||element.attachEvent)){name="keydown"
}if(!this.observers){this.observers={}
}if(!element._eventCacheID){var idPrefix="eventCacheID_";
if(element.id){idPrefix=element.id+"_"+idPrefix
}element._eventCacheID=OpenCharts.Util.createUniqueID(idPrefix)
}var cacheID=element._eventCacheID;
if(!this.observers[cacheID]){this.observers[cacheID]=[]
}this.observers[cacheID].push({element:element,name:name,observer:observer,useCapture:useCapture});
if(element.addEventListener){element.addEventListener(name,observer,useCapture)
}else{if(element.attachEvent){element.attachEvent("on"+name,observer)
}}},stopObservingElement:function(elementParam){var element=OpenCharts.Util.getElement(elementParam);
var cacheID=element._eventCacheID;
this._removeElementObservers(OpenCharts.Event.observers[cacheID])
},_removeElementObservers:function(elementObservers){if(elementObservers){for(var i=elementObservers.length-1;
i>=0;
i--){var entry=elementObservers[i];
var args=new Array(entry.element,entry.name,entry.observer,entry.useCapture);
var removed=OpenCharts.Event.stopObserving.apply(this,args)
}}},stopObserving:function(elementParam,name,observer,useCapture){useCapture=useCapture||false;
var element=OpenCharts.Util.getElement(elementParam);
var cacheID=element._eventCacheID;
if(name=="keypress"){if(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||element.detachEvent){name="keydown"
}}var foundEntry=false;
var elementObservers=OpenCharts.Event.observers[cacheID];
if(elementObservers){var i=0;
while(!foundEntry&&i<elementObservers.length){var cacheEntry=elementObservers[i];
if((cacheEntry.name==name)&&(cacheEntry.observer==observer)&&(cacheEntry.useCapture==useCapture)){elementObservers.splice(i,1);
if(elementObservers.length==0){delete OpenCharts.Event.observers[cacheID]
}foundEntry=true;
break
}i++
}}if(foundEntry){if(element.removeEventListener){element.removeEventListener(name,observer,useCapture)
}else{if(element&&element.detachEvent){element.detachEvent("on"+name,observer)
}}}return foundEntry
},unloadCache:function(){if(OpenCharts.Event&&OpenCharts.Event.observers){for(var cacheID in OpenCharts.Event.observers){var elementObservers=OpenCharts.Event.observers[cacheID];
OpenCharts.Event._removeElementObservers.apply(this,[elementObservers])
}OpenCharts.Event.observers=false
}},CLASS_NAME:"OpenCharts.Event"};
OpenCharts.Event.observe(window,"unload",OpenCharts.Event.unloadCache,false);
if(window.Event){OpenCharts.Util.applyDefaults(window.Event,OpenCharts.Event)
}else{var Event=OpenCharts.Event
}OpenCharts.Events=OpenCharts.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur"],listeners:null,object:null,element:null,eventTypes:null,eventHandler:null,fallThrough:null,includeXY:false,initialize:function(object,element,eventTypes,fallThrough,options){OpenCharts.Util.extend(this,options);
this.object=object;
this.element=element;
this.fallThrough=fallThrough;
this.listeners={};
this.eventHandler=OpenCharts.Function.bindAsEventListener(this.handleBrowserEvent,this);
this.eventTypes=[];
if(eventTypes!=null){for(var i=0,len=eventTypes.length;
i<len;
i++){this.addEventType(eventTypes[i])
}}if(this.element!=null){this.attachToElement(element)
}},destroy:function(){if(this.element){OpenCharts.Event.stopObservingElement(this.element)
}this.element=null;
this.listeners=null;
this.object=null;
this.eventTypes=null;
this.fallThrough=null;
this.eventHandler=null
},addEventType:function(eventName){if(!this.listeners[eventName]){this.eventTypes.push(eventName);
this.listeners[eventName]=[]
}},attachToElement:function(element){for(var i=0,len=this.BROWSER_EVENTS.length;
i<len;
i++){var eventType=this.BROWSER_EVENTS[i];
this.addEventType(eventType);
OpenCharts.Event.observe(element,eventType,this.eventHandler)
}OpenCharts.Event.observe(element,"dragstart",OpenCharts.Event.stop)
},on:function(object){for(var type in object){if(type!="scope"){this.register(type,object.scope,object[type])
}}},register:function(type,obj,func){if((func!=null)&&(OpenCharts.Util.indexOf(this.eventTypes,type)!=-1)){if(obj==null){obj=this.object
}var listeners=this.listeners[type];
listeners.push({obj:obj,func:func})
}},registerPriority:function(type,obj,func){if(func!=null){if(obj==null){obj=this.object
}var listeners=this.listeners[type];
if(listeners!=null){listeners.unshift({obj:obj,func:func})
}}},un:function(object){for(var type in object){if(type!="scope"){this.unregister(type,object.scope,object[type])
}}},unregister:function(type,obj,func){if(obj==null){obj=this.object
}var listeners=this.listeners[type];
if(listeners!=null){for(var i=0,len=listeners.length;
i<len;
i++){if(listeners[i].obj==obj&&listeners[i].func==func){listeners.splice(i,1);
break
}}}},remove:function(type){if(this.listeners[type]!=null){this.listeners[type]=[]
}},triggerEvent:function(type,evt){if(evt==null){evt={}
}evt.object=this.object;
evt.element=this.element;
if(!evt.type){evt.type=type
}var listeners=(this.listeners[type])?this.listeners[type].slice():null;
if((listeners!=null)&&(listeners.length>0)){var continueChain;
for(var i=0,len=listeners.length;
i<len;
i++){var callback=listeners[i];
continueChain=callback.func.apply(callback.obj,[evt]);
if((continueChain!=undefined)&&(continueChain==false)){break
}}if(!this.fallThrough){OpenCharts.Event.stop(evt,true)
}}return continueChain
},handleBrowserEvent:function(evt){if(this.includeXY){evt.xy=this.getMousePosition(evt)
}this.triggerEvent(evt.type,evt)
},clearMouseCache:function(){this.element.scrolls=null;
this.element.lefttop=null;
this.element.offsets=null
},getMousePosition:function(evt){if(!this.includeXY){this.clearMouseCache()
}else{if(!this.element.hasScrollEvent){OpenCharts.Event.observe(window,"scroll",OpenCharts.Function.bind(this.clearMouseCache,this));
this.element.hasScrollEvent=true
}}if(!this.element.scrolls){this.element.scrolls=[];
this.element.scrolls[0]=0;
this.element.scrolls[1]=0
}if(!this.element.lefttop){this.element.lefttop=[];
this.element.lefttop[0]=(document.documentElement.clientLeft||0);
this.element.lefttop[1]=(document.documentElement.clientTop||0)
}if(!this.element.offsets){this.element.offsets=OpenCharts.Util.pagePosition(this.element);
this.element.offsets[0]+=this.element.scrolls[0];
this.element.offsets[1]+=this.element.scrolls[1]
}return new OpenCharts.Pixel((evt.clientX+this.element.scrolls[0])-this.element.offsets[0]-this.element.lefttop[0],(evt.clientY+this.element.scrolls[1])-this.element.offsets[1]-this.element.lefttop[1])
},CLASS_NAME:"OpenCharts.Events"});OpenCharts.Map=OpenCharts.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1000},EVENT_TYPES:["preaddlayer","addlayer","removelayer","changelayer","movestart","move","moveend","zoomend","popupopen","popupclose","addmarker","removemarker","clearmarkers","mouseover","mouseout","mousemove","dragstart","drag","dragend","changebaselayer"],id:null,fractionalZoom:false,events:null,div:null,dragging:false,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,viewRequestID:0,tileSize:null,projection:"EPSG:4326",units:"degrees",resolutions:null,maxResolution:1.40625,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:true,panTween:null,eventListeners:null,panMethod:null,paddingForPopups:null,initialize:function(div,options){this.tileSize=new OpenCharts.Size(OpenCharts.Map.TILE_WIDTH,OpenCharts.Map.TILE_HEIGHT);
this.maxExtent=new OpenCharts.Bounds(-180,-90,180,90);
this.paddingForPopups=new OpenCharts.Bounds(15,15,15,15);
this.theme=OpenCharts._getScriptLocation()+"theme/default/style.css";
OpenCharts.Util.extend(this,options);
this.id=OpenCharts.Util.createUniqueID("OpenCharts.Map_");
this.div=OpenCharts.Util.getElement(div);
OpenCharts.Element.addClass(this.div,"olMap");
var id=this.div.id+"_OpenCharts_ViewPort";
this.viewPortDiv=OpenCharts.Util.createDiv(id,null,null,null,"relative",null,"hidden");
this.viewPortDiv.style.width="100%";
this.viewPortDiv.style.height="100%";
this.viewPortDiv.className="olMapViewport";
this.div.appendChild(this.viewPortDiv);
id=this.div.id+"_OpenCharts_Container";
this.layerContainerDiv=OpenCharts.Util.createDiv(id);
this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1;
this.viewPortDiv.appendChild(this.layerContainerDiv);
this.events=new OpenCharts.Events(this,this.div,this.EVENT_TYPES,this.fallThrough,{includeXY:true});
this.updateSize();
if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)
}this.events.register("movestart",this,this.updateSize);
if(OpenCharts.String.contains(navigator.appName,"Microsoft")){this.events.register("resize",this,this.updateSize)
}else{this.updateSizeDestroy=OpenCharts.Function.bind(this.updateSize,this);
OpenCharts.Event.observe(window,"resize",this.updateSizeDestroy)
}if(this.theme){var addNode=true;
var nodes=document.getElementsByTagName("link");
for(var i=0,len=nodes.length;
i<len;
++i){if(OpenCharts.Util.isEquivalentUrl(nodes.item(i).href,this.theme)){addNode=false;
break
}}if(addNode){var cssNode=document.createElement("link");
cssNode.setAttribute("rel","stylesheet");
cssNode.setAttribute("type","text/css");
cssNode.setAttribute("href",this.theme);
document.getElementsByTagName("head")[0].appendChild(cssNode)
}}this.layers=[];
if(this.controls==null){if(OpenCharts.Control!=null){this.controls=[new OpenCharts.Control.Navigation(),new OpenCharts.Control.PanZoom(),new OpenCharts.Control.ArgParser(),new OpenCharts.Control.Attribution()]
}else{this.controls=[]
}}for(var i=0,len=this.controls.length;
i<len;
i++){this.addControlToMap(this.controls[i])
}this.popups=[];
this.unloadDestroy=OpenCharts.Function.bind(this.destroy,this);
OpenCharts.Event.observe(window,"unload",this.unloadDestroy)
},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy){return false
}OpenCharts.Event.stopObserving(window,"unload",this.unloadDestroy);
this.unloadDestroy=null;
if(this.updateSizeDestroy){OpenCharts.Event.stopObserving(window,"resize",this.updateSizeDestroy)
}else{this.events.unregister("resize",this,this.updateSize)
}this.paddingForPopups=null;
if(this.controls!=null){for(var i=this.controls.length-1;
i>=0;
--i){this.controls[i].destroy()
}this.controls=null
}if(this.layers!=null){for(var i=this.layers.length-1;
i>=0;
--i){this.layers[i].destroy(false)
}this.layers=null
}if(this.viewPortDiv){this.div.removeChild(this.viewPortDiv)
}this.viewPortDiv=null;
if(this.eventListeners){this.events.un(this.eventListeners);
this.eventListeners=null
}this.events.destroy();
this.events=null
},setOptions:function(options){OpenCharts.Util.extend(this,options)
},getTileSize:function(){return this.tileSize
},getBy:function(array,property,match){var test=(typeof match.test=="function");
var found=OpenCharts.Array.filter(this[array],function(item){return item[property]==match||(test&&match.test(item[property]))
});
return found
},getLayersBy:function(property,match){return this.getBy("layers",property,match)
},getLayersByName:function(match){return this.getLayersBy("name",match)
},getLayersByClass:function(match){return this.getLayersBy("CLASS_NAME",match)
},getControlsBy:function(property,match){return this.getBy("controls",property,match)
},getControlsByClass:function(match){return this.getControlsBy("CLASS_NAME",match)
},getLayer:function(id){var foundLayer=null;
for(var i=0,len=this.layers.length;
i<len;
i++){var layer=this.layers[i];
if(layer.id==id){foundLayer=layer;
break
}}return foundLayer
},setLayerZIndex:function(layer,zIdx){layer.setZIndex(this.Z_INDEX_BASE[layer.isBaseLayer?"BaseLayer":"Overlay"]+zIdx*5)
},resetLayersZIndex:function(){for(var i=0,len=this.layers.length;
i<len;
i++){var layer=this.layers[i];
this.setLayerZIndex(layer,i)
}},addLayer:function(layer){for(var i=0,len=this.layers.length;
i<len;
i++){if(this.layers[i]==layer){var msg=OpenCharts.i18n("layerAlreadyAdded",{layerName:layer.name});
OpenCharts.Console.warn(msg);
return false
}}this.events.triggerEvent("preaddlayer",{layer:layer});
layer.div.className="olLayerDiv";
layer.div.style.overflow="";
this.setLayerZIndex(layer,this.layers.length);
if(layer.isFixed){this.viewPortDiv.appendChild(layer.div)
}else{this.layerContainerDiv.appendChild(layer.div)
}this.layers.push(layer);
layer.setMap(this);
if(layer.isBaseLayer){if(this.baseLayer==null){this.setBaseLayer(layer)
}else{layer.setVisibility(false)
}}else{layer.redraw()
}this.events.triggerEvent("addlayer",{layer:layer})
},addLayers:function(layers){for(var i=0,len=layers.length;
i<len;
i++){this.addLayer(layers[i])
}},removeLayer:function(layer,setNewBaseLayer){if(setNewBaseLayer==null){setNewBaseLayer=true
}if(layer.isFixed){this.viewPortDiv.removeChild(layer.div)
}else{this.layerContainerDiv.removeChild(layer.div)
}OpenCharts.Util.removeItem(this.layers,layer);
layer.removeMap(this);
layer.map=null;
if(this.baseLayer==layer){this.baseLayer=null;
if(setNewBaseLayer){for(var i=0,len=this.layers.length;
i<len;
i++){var iLayer=this.layers[i];
if(iLayer.isBaseLayer){this.setBaseLayer(iLayer);
break
}}}}this.resetLayersZIndex();
this.events.triggerEvent("removelayer",{layer:layer})
},getNumLayers:function(){return this.layers.length
},getLayerIndex:function(layer){return OpenCharts.Util.indexOf(this.layers,layer)
},setLayerIndex:function(layer,idx){var base=this.getLayerIndex(layer);
if(idx<0){idx=0
}else{if(idx>this.layers.length){idx=this.layers.length
}}if(base!=idx){this.layers.splice(base,1);
this.layers.splice(idx,0,layer);
for(var i=0,len=this.layers.length;
i<len;
i++){this.setLayerZIndex(this.layers[i],i)
}this.events.triggerEvent("changelayer",{layer:layer,property:"order"})
}},raiseLayer:function(layer,delta){var idx=this.getLayerIndex(layer)+delta;
this.setLayerIndex(layer,idx)
},setBaseLayer:function(newBaseLayer){var oldExtent=null;
if(this.baseLayer){oldExtent=this.baseLayer.getExtent()
}if(newBaseLayer!=this.baseLayer){if(OpenCharts.Util.indexOf(this.layers,newBaseLayer)!=-1){if(this.baseLayer!=null){this.baseLayer.setVisibility(false)
}this.baseLayer=newBaseLayer;
this.viewRequestID++;
this.baseLayer.visibility=true;
var center=this.getCenter();
if(center!=null){var newCenter=(oldExtent)?oldExtent.getCenterLonLat():center;
var newZoom=(oldExtent)?this.getZoomForExtent(oldExtent,true):this.getZoomForResolution(this.resolution,true);
this.setCenter(newCenter,newZoom,false,true)
}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})
}}},addControl:function(control,px){this.controls.push(control);
this.addControlToMap(control,px)
},addControlToMap:function(control,px){control.outsideViewport=(control.div!=null);
if(this.displayProjection&&!control.displayProjection){control.displayProjection=this.displayProjection
}control.setMap(this);
var div=control.draw(px);
if(div){if(!control.outsideViewport){div.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length;
this.viewPortDiv.appendChild(div)
}}},getControl:function(id){var returnControl=null;
for(var i=0,len=this.controls.length;
i<len;
i++){var control=this.controls[i];
if(control.id==id){returnControl=control;
break
}}return returnControl
},removeControl:function(control){if((control)&&(control==this.getControl(control.id))){if(control.div&&(control.div.parentNode==this.viewPortDiv)){this.viewPortDiv.removeChild(control.div)
}OpenCharts.Util.removeItem(this.controls,control)
}},addPopup:function(popup,exclusive){if(exclusive){for(var i=this.popups.length-1;
i>=0;
--i){this.removePopup(this.popups[i])
}}popup.map=this;
this.popups.push(popup);
var popupDiv=popup.draw();
if(popupDiv){popupDiv.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length;
this.layerContainerDiv.appendChild(popupDiv)
}},removePopup:function(popup){OpenCharts.Util.removeItem(this.popups,popup);
if(popup.div){try{this.layerContainerDiv.removeChild(popup.div)
}catch(e){}}popup.map=null
},getSize:function(){var size=null;
if(this.size!=null){size=this.size.clone()
}return size
},updateSize:function(){this.events.clearMouseCache();
var newSize=this.getCurrentSize();
var oldSize=this.getSize();
if(oldSize==null){this.size=oldSize=newSize
}if(!newSize.equals(oldSize)){this.size=newSize;
for(var i=0,len=this.layers.length;
i<len;
i++){this.layers[i].onMapResize()
}if(this.baseLayer!=null){var center=new OpenCharts.Pixel(newSize.w/2,newSize.h/2);
var centerLL=this.getLonLatFromViewPortPx(center);
var zoom=this.getZoom();
this.zoom=null;
this.setCenter(this.getCenter(),zoom)
}}},getCurrentSize:function(){var size=new OpenCharts.Size(this.div.clientWidth,this.div.clientHeight);
if(size.w==0&&size.h==0||isNaN(size.w)&&isNaN(size.h)){var dim=OpenCharts.Element.getDimensions(this.div);
size.w=dim.width;
size.h=dim.height
}if(size.w==0&&size.h==0||isNaN(size.w)&&isNaN(size.h)){size.w=parseInt(this.div.style.width);
size.h=parseInt(this.div.style.height)
}return size
},calculateBounds:function(center,resolution){var extent=null;
if(center==null){center=this.getCenter()
}if(resolution==null){resolution=this.getResolution()
}if((center!=null)&&(resolution!=null)){var size=this.getSize();
var w_deg=size.w*resolution;
var h_deg=size.h*resolution;
extent=new OpenCharts.Bounds(center.lon-w_deg/2,center.lat-h_deg/2,center.lon+w_deg/2,center.lat+h_deg/2)
}return extent
},getCenter:function(){return this.center
},getZoom:function(){return this.zoom
},pan:function(dx,dy,options){options=OpenCharts.Util.applyDefaults(options,{animate:true,dragging:false});
var centerPx=this.getViewPortPxFromLonLat(this.getCenter());
var newCenterPx=centerPx.add(dx,dy);
if(!options.dragging||!newCenterPx.equals(centerPx)){var newCenterLonLat=this.getLonLatFromViewPortPx(newCenterPx);
if(options.animate){this.panTo(newCenterLonLat)
}else{this.setCenter(newCenterLonLat,null,options.dragging)
}}},panTo:function(lonlat){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(lonlat)){if(!this.panTween){this.panTween=new OpenCharts.Tween(this.panMethod)
}var center=this.getCenter();
if(lonlat.lon==center.lon&&lonlat.lat==center.lat){return 
}var from={lon:center.lon,lat:center.lat};
var to={lon:lonlat.lon,lat:lonlat.lat};
this.panTween.start(from,to,50,{callbacks:{start:OpenCharts.Function.bind(function(lonlat){this.events.triggerEvent("movestart")
},this),eachStep:OpenCharts.Function.bind(function(lonlat){lonlat=new OpenCharts.LonLat(lonlat.lon,lonlat.lat);
this.moveTo(lonlat,this.zoom,{dragging:true,noEvent:true})
},this),done:OpenCharts.Function.bind(function(lonlat){lonlat=new OpenCharts.LonLat(lonlat.lon,lonlat.lat);
this.moveTo(lonlat,this.zoom,{noEvent:true});
this.events.triggerEvent("moveend")
},this)}})
}else{this.setCenter(lonlat)
}},setCenter:function(lonlat,zoom,dragging,forceZoomChange){this.moveTo(lonlat,zoom,{dragging:dragging,forceZoomChange:forceZoomChange,caller:"setCenter"})
},moveTo:function(lonlat,zoom,options){if(!options){options={}
}var dragging=options.dragging;
var forceZoomChange=options.forceZoomChange;
var noEvent=options.noEvent;
if(this.panTween&&options.caller=="setCenter"){this.panTween.stop()
}if(!this.center&&!this.isValidLonLat(lonlat)){lonlat=this.maxExtent.getCenterLonLat()
}if(this.restrictedExtent!=null){if(lonlat==null){lonlat=this.getCenter()
}if(zoom==null){zoom=this.getZoom()
}var resolution=this.getResolutionForZoom(zoom);
var extent=this.calculateBounds(lonlat,resolution);
if(!this.restrictedExtent.containsBounds(extent)){var maxCenter=this.restrictedExtent.getCenterLonLat();
if(extent.getWidth()>this.restrictedExtent.getWidth()){lonlat=new OpenCharts.LonLat(maxCenter.lon,lonlat.lat)
}else{if(extent.left<this.restrictedExtent.left){lonlat=lonlat.add(this.restrictedExtent.left-extent.left,0)
}else{if(extent.right>this.restrictedExtent.right){lonlat=lonlat.add(this.restrictedExtent.right-extent.right,0)
}}}if(extent.getHeight()>this.restrictedExtent.getHeight()){lonlat=new OpenCharts.LonLat(lonlat.lon,maxCenter.lat)
}else{if(extent.bottom<this.restrictedExtent.bottom){lonlat=lonlat.add(0,this.restrictedExtent.bottom-extent.bottom)
}else{if(extent.top>this.restrictedExtent.top){lonlat=lonlat.add(0,this.restrictedExtent.top-extent.top)
}}}}}var zoomChanged=forceZoomChange||((this.isValidZoomLevel(zoom))&&(zoom!=this.getZoom()));
var centerChanged=(this.isValidLonLat(lonlat))&&(!lonlat.equals(this.center));
if(zoomChanged||centerChanged||!dragging){if(!this.dragging&&!noEvent){this.events.triggerEvent("movestart")
}if(centerChanged){if((!zoomChanged)&&(this.center)){this.centerLayerContainer(lonlat)
}this.center=lonlat.clone()
}if((zoomChanged)||(this.layerContainerOrigin==null)){this.layerContainerOrigin=this.center.clone();
this.layerContainerDiv.style.left="0px";
this.layerContainerDiv.style.top="0px"
}if(zoomChanged){this.zoom=zoom;
this.resolution=this.getResolutionForZoom(zoom);
this.viewRequestID++
}var bounds=this.getExtent();
this.baseLayer.moveTo(bounds,zoomChanged,dragging);
bounds=this.baseLayer.getExtent();
for(var i=0,len=this.layers.length;
i<len;
i++){var layer=this.layers[i];
if(!layer.isBaseLayer){var inRange=layer.calculateInRange();
if(layer.inRange!=inRange){layer.inRange=inRange;
if(!inRange){layer.display(false)
}this.events.triggerEvent("changelayer",{layer:layer,property:"visibility"})
}if(inRange&&layer.visibility){layer.moveTo(bounds,zoomChanged,dragging);
layer.events.triggerEvent("moveend",{zoomChanged:zoomChanged})
}}}if(zoomChanged){for(var i=0,len=this.popups.length;
i<len;
i++){this.popups[i].updatePosition()
}}this.events.triggerEvent("move");
if(zoomChanged){this.events.triggerEvent("zoomend")
}}if(!dragging&&!noEvent){this.events.triggerEvent("moveend")
}this.dragging=!!dragging
},centerLayerContainer:function(lonlat){var originPx=this.getViewPortPxFromLonLat(this.layerContainerOrigin);
var newPx=this.getViewPortPxFromLonLat(lonlat);
if((originPx!=null)&&(newPx!=null)){this.layerContainerDiv.style.left=Math.round(originPx.x-newPx.x)+"px";
this.layerContainerDiv.style.top=Math.round(originPx.y-newPx.y)+"px"
}},isValidZoomLevel:function(zoomLevel){return((zoomLevel!=null)&&(zoomLevel>=0)&&(zoomLevel<this.getNumZoomLevels()))
},isValidLonLat:function(lonlat){var valid=false;
if(lonlat!=null){var maxExtent=this.getMaxExtent();
valid=maxExtent.containsLonLat(lonlat)
}return valid
},getProjection:function(){var projection=this.getProjectionObject();
return projection?projection.getCode():null
},getProjectionObject:function(){var projection=null;
if(this.baseLayer!=null){projection=this.baseLayer.projection
}return projection
},getMaxResolution:function(){var maxResolution=null;
if(this.baseLayer!=null){maxResolution=this.baseLayer.maxResolution
}return maxResolution
},getMaxExtent:function(options){var maxExtent=null;
if(options&&options.restricted&&this.restrictedExtent){maxExtent=this.restrictedExtent
}else{if(this.baseLayer!=null){maxExtent=this.baseLayer.maxExtent
}}return maxExtent
},getNumZoomLevels:function(){var numZoomLevels=null;
if(this.baseLayer!=null){numZoomLevels=this.baseLayer.numZoomLevels
}return numZoomLevels
},getExtent:function(){var extent=null;
if(this.baseLayer!=null){extent=this.baseLayer.getExtent()
}return extent
},getResolution:function(){var resolution=null;
if(this.baseLayer!=null){resolution=this.baseLayer.getResolution()
}return resolution
},getUnits:function(){var units=null;
if(this.baseLayer!=null){units=this.baseLayer.units
}return units
},getScale:function(){var scale=null;
if(this.baseLayer!=null){var res=this.getResolution();
var units=this.baseLayer.units;
scale=OpenCharts.Util.getScaleFromResolution(res,units)
}return scale
},getZoomForExtent:function(bounds,closest){var zoom=null;
if(this.baseLayer!=null){zoom=this.baseLayer.getZoomForExtent(bounds,closest)
}return zoom
},getResolutionForZoom:function(zoom){var resolution=null;
if(this.baseLayer){resolution=this.baseLayer.getResolutionForZoom(zoom)
}return resolution
},getZoomForResolution:function(resolution,closest){var zoom=null;
if(this.baseLayer!=null){zoom=this.baseLayer.getZoomForResolution(resolution,closest)
}return zoom
},zoomTo:function(zoom){if(this.isValidZoomLevel(zoom)){this.setCenter(null,zoom)
}},zoomIn:function(){this.zoomTo(this.getZoom()+1)
},zoomOut:function(){this.zoomTo(this.getZoom()-1)
},zoomToExtent:function(bounds,closest){var center=bounds.getCenterLonLat();
if(this.baseLayer.wrapDateLine){var maxExtent=this.getMaxExtent();
bounds=bounds.clone();
while(bounds.right<bounds.left){bounds.right+=maxExtent.getWidth()
}center=bounds.getCenterLonLat().wrapDateLine(maxExtent)
}this.setCenter(center,this.getZoomForExtent(bounds,closest))
},zoomToMaxExtent:function(options){var restricted=(options)?options.restricted:true;
var maxExtent=this.getMaxExtent({restricted:restricted});
this.zoomToExtent(maxExtent)
},zoomToScale:function(scale,closest){var res=OpenCharts.Util.getResolutionFromScale(scale,this.baseLayer.units);
var size=this.getSize();
var w_deg=size.w*res;
var h_deg=size.h*res;
var center=this.getCenter();
var extent=new OpenCharts.Bounds(center.lon-w_deg/2,center.lat-h_deg/2,center.lon+w_deg/2,center.lat+h_deg/2);
this.zoomToExtent(extent,closest)
},getLonLatFromViewPortPx:function(viewPortPx){var lonlat=null;
if(this.baseLayer!=null){lonlat=this.baseLayer.getLonLatFromViewPortPx(viewPortPx)
}return lonlat
},getViewPortPxFromLonLat:function(lonlat){var px=null;
if(this.baseLayer!=null){px=this.baseLayer.getViewPortPxFromLonLat(lonlat)
}return px
},getLonLatFromPixel:function(px){return this.getLonLatFromViewPortPx(px)
},getPixelFromLonLat:function(lonlat){var px=this.getViewPortPxFromLonLat(lonlat);
px.x=Math.round(px.x);
px.y=Math.round(px.y);
return px
},getViewPortPxFromLayerPx:function(layerPx){var viewPortPx=null;
if(layerPx!=null){var dX=parseInt(this.layerContainerDiv.style.left);
var dY=parseInt(this.layerContainerDiv.style.top);
viewPortPx=layerPx.add(dX,dY)
}return viewPortPx
},getLayerPxFromViewPortPx:function(viewPortPx){var layerPx=null;
if(viewPortPx!=null){var dX=-parseInt(this.layerContainerDiv.style.left);
var dY=-parseInt(this.layerContainerDiv.style.top);
layerPx=viewPortPx.add(dX,dY);
if(isNaN(layerPx.x)||isNaN(layerPx.y)){layerPx=null
}}return layerPx
},getLonLatFromLayerPx:function(px){px=this.getViewPortPxFromLayerPx(px);
return this.getLonLatFromViewPortPx(px)
},getLayerPxFromLonLat:function(lonlat){var px=this.getPixelFromLonLat(lonlat);
return this.getLayerPxFromViewPortPx(px)
},CLASS_NAME:"OpenCharts.Map"});
OpenCharts.Map.TILE_WIDTH=256;
OpenCharts.Map.TILE_HEIGHT=256;function setMfIds(chartId,formId,ajaxCompId){window.mfChartId=chartId;
window.mfFormId=formId;
window.mfAjaxCompId=ajaxCompId
}top.setMfIds=setMfIds;
OpenCharts.Map=OpenCharts.Class(OpenCharts.Map,{panMethod:null,isSVG:true,isHTML:false,isVML:false,renderers:["SVG","VML","Canvas","HTML"],renderer:null,rendererOptions:{resolution:1},assignRenderer:function(){for(var i=0,len=this.renderers.length;
i<this.renderers.length;
i++){var rendererClass=OpenCharts.Renderer[this.renderers[i]];
if(rendererClass&&rendererClass.prototype.supported()){this.renderer=new rendererClass(this.div,this.rendererOptions);
break
}}},getResolution:function(){return 1
},currentExtent:null,mfAjaxCompId:null,initialize:function(div,options){this.tileSize=new OpenCharts.Size(OpenCharts.Map.TILE_WIDTH,OpenCharts.Map.TILE_HEIGHT);
this.maxExtent=new OpenCharts.Bounds(-180,-90,180,90);
this.center=new OpenCharts.LonLat(0,0);
this.paddingForPopups=new OpenCharts.Bounds(15,15,15,15);
OpenCharts.Util.extend(this,options);
this.div=OpenCharts.Util.getElement(div);
this.assignRenderer();
this.renderer.map=this;
this.renderer.assignMapElements();
this.events=new OpenCharts.Events(this,this.div,this.EVENT_TYPES,this.fallThrough,{includeXY:true});
this.popups=[];
this.layers=[];
this.initResolutions();
var size=this.getSize();
this.center=this.getLonLatFromViewPortPx(new OpenCharts.Pixel(size.w/2,size.h/2));
this.updateSize();
if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)
}this.events.register("movestart",this,this.updateSize);
if(OpenCharts.String.contains(navigator.appName,"Microsoft")){this.events.register("resize",this,this.updateSize)
}else{this.updateSizeDestroy=OpenCharts.Function.bind(this.updateSize,this);
OpenCharts.Event.observe(window,"resize",this.updateSizeDestroy)
}if(this.controls==null){this.controls=[];
if(OpenCharts.Control!=null){this.controls.push(new OpenCharts.Control.Navigation())
}else{}}for(var i=0;
i<this.controls.length;
i++){this.addControlToMap(this.controls[i])
}this.unloadDestroy=OpenCharts.Function.bind(this.destroy,this);
OpenCharts.Event.observe(window,"unload",this.unloadDestroy);
this.events.register("moveend",null,this.sendAjaxRequest);
this.events.register("moveend",null,this.setCurrentExtent)
},initResolutions:function(){var props=new Array("projection","units","scales","resolutions","maxScale","minScale","maxResolution","minResolution","minExtent","maxExtent","numZoomLevels","maxZoomLevel");
if(this.options==null){this.options={}
}var confProps={};
for(var i=0;
i<props.length;
i++){var property=props[i];
confProps[property]=this.options[property]||this[property]
}if(this.options.minScale!=null&&this.options.maxScale!=null&&this.options.scales==null){confProps.scales=null
}if(this.options.minResolution!=null&&this.options.maxResolution!=null&&this.options.resolutions==null){confProps.resolutions=null
}if((!confProps.numZoomLevels)&&(confProps.maxZoomLevel)){confProps.numZoomLevels=confProps.maxZoomLevel+1
}if((confProps.scales!=null)||(confProps.resolutions!=null)){if(confProps.scales!=null){confProps.resolutions=[];
for(var i=0;
i<confProps.scales.length;
i++){var scale=confProps.scales[i];
confProps.resolutions[i]=OpenCharts.Util.getResolutionFromScale(scale,confProps.units)
}}confProps.numZoomLevels=confProps.resolutions.length
}else{if(confProps.minScale){confProps.maxResolution=OpenCharts.Util.getResolutionFromScale(confProps.minScale,confProps.units)
}else{if(confProps.maxResolution=="auto"){var viewSize=this.getSize();
var wRes=confProps.maxExtent.getWidth()/viewSize.w;
var hRes=confProps.maxExtent.getHeight()/viewSize.h;
confProps.maxResolution=Math.max(wRes,hRes)
}}if(confProps.maxScale!=null){confProps.minResolution=OpenCharts.Util.getResolutionFromScale(confProps.maxScale,confProps.units)
}else{if((confProps.minResolution=="auto")&&(confProps.minExtent!=null)){var viewSize=this.getSize();
var wRes=confProps.minExtent.getWidth()/viewSize.w;
var hRes=confProps.minExtent.getHeight()/viewSize.h;
confProps.minResolution=Math.max(wRes,hRes)
}}if(confProps.minResolution!=null&&this.options.numZoomLevels==undefined){var ratio=confProps.maxResolution/confProps.minResolution;
confProps.numZoomLevels=Math.floor(Math.log(ratio)/Math.log(2))+1
}confProps.resolutions=new Array(confProps.numZoomLevels);
var base=2;
if(typeof confProps.minResolution=="number"&&confProps.numZoomLevels>1){base=Math.pow((confProps.maxResolution/confProps.minResolution),(1/(confProps.numZoomLevels-1)))
}for(var i=0;
i<confProps.numZoomLevels;
i++){var res=confProps.maxResolution/Math.pow(base,i);
confProps.resolutions[i]=res
}}confProps.resolutions.sort(function(a,b){return(b-a)
});
this.resolutions=confProps.resolutions;
this.maxResolution=confProps.resolutions[0];
var lastIndex=confProps.resolutions.length-1;
this.minResolution=confProps.resolutions[lastIndex];
this.scales=[];
for(var i=0;
i<confProps.resolutions.length;
i++){this.scales[i]=OpenCharts.Util.getScaleFromResolution(confProps.resolutions[i],confProps.units)
}this.minScale=this.scales[0];
this.maxScale=this.scales[this.scales.length-1];
this.numZoomLevels=confProps.numZoomLevels
},getCurrentExtent:function(){return this.currentExtent
},setCurrentExtent:function(){this.currentExtent=this.getExtent()
},sendAjaxRequest:function(parameters){this.mfChartId=window.mfChartId;
this.mfFormId=window.mfFormId;
this.mfAjaxCompId=window.mfAjaxCompId;
var tag=top.document.getElementById(this.mfChartId);
parameters[this.mfAjaxCompId]=this.mfAjaxCompId;
parameters.refresh=this.mfChartId;
parameters["chart.rerender"]=true;
var str="";
if(top.A4J){top.A4J.AJAX.Submit("updateChart",this.mfFormId,null,{control:this,parameters:parameters,actionUrl:top.location.href});
if(tag){var elt=top.document.createElement("div");
elt.setAttribute("id",this.mfChartId);
elt.setAttribute("style","display:none;width:0px;height:0px;");
elt.setAttribute("width","0");
elt.setAttribute("height","0")
}else{alert("The element with the id '"+this.mfChartId+"' doesn't exist !!!!!")
}}else{alert("A4J is not defined")
}},zoomToBox:function(bounds,out){if(!isNaN(bounds.left)||!isNaN(bounds.bottom)||!isNaN(bounds.right)||!isNaN(bounds.top)){this.renderer.zoomToBox(bounds,out)
}},zoomToPixel:function(pixel,out){if(!isNaN(pixel.x)||!isNaN(pixel.y)){this.renderer.zoomToPixel(pixel,out)
}},pan:function(dx,dy,options){this.renderer.pan(dx,dy,options)
},panToPixel:function(pixel){if(!isNaN(pixel.x)||!isNaN(pixel.y)){this.renderer.panToPixel(pixel)
}},destroy:function(){if(!this.unloadDestroy){return false
}OpenCharts.Event.stopObserving(window,"unload",this.unloadDestroy);
this.unloadDestroy=null;
if(this.updateSizeDestroy){OpenCharts.Event.stopObserving(window,"resize",this.updateSizeDestroy)
}else{this.events.unregister("resize",this,this.updateSize)
}this.paddingForPopups=null;
if(this.controls!=null){for(var i=this.controls.length-1;
i>=0;
--i){this.controls[i].destroy()
}this.controls=null
}if(this.layers!=null){for(var i=this.layers.length-1;
i>=0;
--i){this.layers[i].destroy(false)
}this.layers=null
}this.renderer.destroyMapElements();
this.renderer=null;
if(this.eventListeners){this.events.un(this.eventListeners);
this.eventListeners=null
}this.events.destroy();
this.events=null
}});OpenCharts.Handler=OpenCharts.Class({id:null,control:null,map:null,keyMask:null,active:false,evt:null,initialize:function(control,callbacks,options){OpenCharts.Util.extend(this,options);
this.control=control;
this.callbacks=callbacks;
if(control.map){this.setMap(control.map)
}OpenCharts.Util.extend(this,options);
this.id=OpenCharts.Util.createUniqueID(this.CLASS_NAME+"_")
},setMap:function(map){this.map=map
},checkModifiers:function(evt){if(this.keyMask==null){return true
}var keyModifiers=(evt.shiftKey?OpenCharts.Handler.MOD_SHIFT:0)|(evt.ctrlKey?OpenCharts.Handler.MOD_CTRL:0)|(evt.altKey?OpenCharts.Handler.MOD_ALT:0);
return(keyModifiers==this.keyMask)
},activate:function(){if(this.active){return false
}var events=OpenCharts.Events.prototype.BROWSER_EVENTS;
for(var i=0,len=events.length;
i<len;
i++){if(this[events[i]]){this.register(events[i],this[events[i]])
}}this.active=true;
return true
},deactivate:function(){if(!this.active){return false
}var events=OpenCharts.Events.prototype.BROWSER_EVENTS;
for(var i=0,len=events.length;
i<len;
i++){if(this[events[i]]){this.unregister(events[i],this[events[i]])
}}this.active=false;
return true
},callback:function(name,args){if(name&&this.callbacks[name]){this.callbacks[name].apply(this.control,args)
}},register:function(name,method){this.map.events.registerPriority(name,this,method);
this.map.events.registerPriority(name,this,this.setEvent)
},unregister:function(name,method){this.map.events.unregister(name,this,method);
this.map.events.unregister(name,this,this.setEvent)
},setEvent:function(evt){this.evt=evt;
return true
},destroy:function(){this.deactivate();
this.control=this.map=null
},CLASS_NAME:"OpenCharts.Handler"});
OpenCharts.Handler.MOD_NONE=0;
OpenCharts.Handler.MOD_SHIFT=1;
OpenCharts.Handler.MOD_CTRL=2;
OpenCharts.Handler.MOD_ALT=4;OpenCharts.Handler.Click=OpenCharts.Class(OpenCharts.Handler,{delay:300,single:true,"double":false,pixelTolerance:0,stopSingle:false,stopDouble:false,timerId:null,down:null,rightclickTimerId:null,initialize:function(control,callbacks,options){OpenCharts.Handler.prototype.initialize.apply(this,arguments);
if(this.pixelTolerance!=null){this.mousedown=function(evt){this.down=evt.xy;
return true
}
}},mousedown:null,mouseup:function(evt){var propagate=true;
if(this.checkModifiers(evt)&&this.control.handleRightClicks&&OpenCharts.Event.isRightClick(evt)){propogate=this.rightclick(evt)
}return propagate
},rightclick:function(evt){if(this.passesTolerance(evt)){if(this.rightclickTimerId!=null){this.clearTimer();
this.callback("dblrightclick",[evt]);
return !this.stopDouble
}else{var clickEvent=this["double"]?OpenCharts.Util.extend({},evt):this.callback("rightclick",[evt]);
var delayedRightCall=OpenCharts.Function.bind(this.delayedRightCall,this,clickEvent);
this.rightclickTimerId=window.setTimeout(delayedRightCall,this.delay)
}}return !this.stopSingle
},delayedRightCall:function(evt){this.rightclickTimerId=null;
if(evt){this.callback("rightclick",[evt])
}return !this.stopSingle
},dblclick:function(evt){if(this.passesTolerance(evt)){if(this["double"]){this.callback("dblclick",[evt])
}this.clearTimer()
}return !this.stopDouble
},click:function(evt){if(this.passesTolerance(evt)){if(this.timerId!=null){this.clearTimer()
}else{var clickEvent=this.single?OpenCharts.Util.extend({},evt):null;
this.timerId=window.setTimeout(OpenCharts.Function.bind(this.delayedCall,this,clickEvent),this.delay)
}}return !this.stopSingle
},passesTolerance:function(evt){var passes=true;
if(this.pixelTolerance!=null&&this.down){var dpx=Math.sqrt(Math.pow(this.down.x-evt.xy.x,2)+Math.pow(this.down.y-evt.xy.y,2));
if(dpx>this.pixelTolerance){passes=false
}}return passes
},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);
this.timerId=null
}},delayedCall:function(evt){this.timerId=null;
if(evt){this.callback("click",[evt])
}},deactivate:function(){var deactivated=false;
if(OpenCharts.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();
this.down=null;
deactivated=true
}return deactivated
},CLASS_NAME:"OpenCharts.Handler.Click"});OpenCharts.Handler.Hover=OpenCharts.Class(OpenCharts.Handler,{delay:500,pixelTolerance:null,stopMove:false,px:null,timerId:null,initialize:function(control,callbacks,options){OpenCharts.Handler.prototype.initialize.apply(this,arguments)
},mousemove:function(evt){if(this.passesTolerance(evt.xy)){this.clearTimer();
this.callback("move",[evt]);
this.px=evt.xy;
evt=OpenCharts.Util.extend({},evt);
this.timerId=window.setTimeout(OpenCharts.Function.bind(this.delayedCall,this,evt),this.delay)
}return !this.stopMove
},mouseout:function(evt){if(OpenCharts.Util.mouseLeft(evt,this.map.div)){this.clearTimer();
this.callback("move",[evt])
}return true
},passesTolerance:function(px){var passes=true;
if(this.pixelTolerance&&this.px){var dpx=Math.sqrt(Math.pow(this.px.x-px.x,2)+Math.pow(this.px.y-px.y,2));
if(dpx<this.pixelTolerance){passes=false
}}return passes
},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);
this.timerId=null
}},delayedCall:function(evt){this.callback("pause",[evt])
},deactivate:function(){var deactivated=false;
if(OpenCharts.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();
deactivated=true
}return deactivated
},CLASS_NAME:"OpenCharts.Handler.Hover"});OpenCharts.Handler.Drag=OpenCharts.Class(OpenCharts.Handler,{started:false,stopDown:true,dragging:false,last:null,start:null,oldOnselectstart:null,interval:0,timeoutId:null,initialize:function(control,callbacks,options){OpenCharts.Handler.prototype.initialize.apply(this,arguments)
},down:function(evt){},move:function(evt){},up:function(evt){},out:function(evt){},mousedown:function(evt){var propagate=true;
this.dragging=false;
if(this.checkModifiers(evt)&&OpenCharts.Event.isLeftClick(evt)){this.started=true;
this.start=evt.xy;
this.last=evt.xy;
this.map.div.style.cursor="move";
this.down(evt);
this.callback("down",[evt.xy]);
OpenCharts.Event.stop(evt);
if(!this.oldOnselectstart){this.oldOnselectstart=(document.onselectstart)?document.onselectstart:function(){return true
};
document.onselectstart=function(){return false
}
}propagate=!this.stopDown
}else{this.started=false;
this.start=null;
this.last=null
}return propagate
},mousemove:function(evt){if(this.started&&!this.timeoutId&&(evt.xy.x!=this.last.x||evt.xy.y!=this.last.y)){if(this.interval>0){this.timeoutId=setTimeout(OpenCharts.Function.bind(this.removeTimeout,this),this.interval)
}this.dragging=true;
this.move(evt);
this.callback("move",[evt.xy]);
if(!this.oldOnselectstart){this.oldOnselectstart=document.onselectstart;
document.onselectstart=function(){return false
}
}this.last=this.evt.xy
}return true
},removeTimeout:function(){this.timeoutId=null
},mouseup:function(evt){if(this.started){var dragged=(this.start!=this.last);
this.started=false;
this.dragging=false;
this.map.div.style.cursor="";
this.up(evt);
this.callback("up",[evt.xy]);
if(dragged){this.callback("done",[evt.xy])
}document.onselectstart=this.oldOnselectstart
}return true
},mouseout:function(evt){if(this.started&&OpenCharts.Util.mouseLeft(evt,this.map.div)){var dragged=(this.start!=this.last);
this.started=false;
this.dragging=false;
this.map.div.style.cursor="";
this.out(evt);
this.callback("out",[]);
if(dragged){this.callback("done",[evt.xy])
}if(document.onselectstart){document.onselectstart=this.oldOnselectstart
}}return true
},click:function(evt){return(this.start==this.last)
},activate:function(){var activated=false;
if(OpenCharts.Handler.prototype.activate.apply(this,arguments)){this.dragging=false;
activated=true
}return activated
},deactivate:function(){var deactivated=false;
if(OpenCharts.Handler.prototype.deactivate.apply(this,arguments)){this.started=false;
this.dragging=false;
this.start=null;
this.last=null;
deactivated=true
}return deactivated
},CLASS_NAME:"OpenCharts.Handler.Drag"});OpenCharts.Handler.Box=OpenCharts.Class(OpenCharts.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxCharacteristics:null,initialize:function(control,callbacks,options){OpenCharts.Handler.prototype.initialize.apply(this,arguments);
var callbacks={down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox};
this.dragHandler=new OpenCharts.Handler.Drag(this,callbacks,{keyMask:this.keyMask})
},setMap:function(map){OpenCharts.Handler.prototype.setMap.apply(this,arguments);
if(this.dragHandler){this.dragHandler.setMap(map)
}},startBox:function(xy){this.geometry=new OpenCharts.Geometry.Rectangle(this.dragHandler.start.x,this.dragHandler.start.y,1,1);
this.zoomBox=this.map.renderer.drawRectangle(this.map.renderer.createBox("zoomBox",this.geometry),this.geometry);
this.map.div.appendChild(this.zoomBox)
},moveBox:function(xy){var startX=this.dragHandler.start.x;
var startY=this.dragHandler.start.y;
var deltaX=Math.abs(startX-xy.x);
var deltaY=Math.abs(startY-xy.y);
this.geometry.width=Math.max(1,deltaX);
this.geometry.height=Math.max(1,deltaY);
this.geometry.x=xy.x<startX?xy.x:startX;
this.geometry.y=xy.y<startY?xy.y:startY;
this.zoomBox=this.map.renderer.drawRectangle(this.zoomBox,this.geometry)
},endBox:function(end){var result;
if(Math.abs(this.dragHandler.start.x-end.x)>5||Math.abs(this.dragHandler.start.y-end.y)>5){var start=this.dragHandler.start;
var top=Math.min(start.y,end.y);
var bottom=Math.max(start.y,end.y);
var left=Math.min(start.x,end.x);
var right=Math.max(start.x,end.x);
result=new OpenCharts.Bounds(left,bottom,right,top)
}else{result=this.dragHandler.start.clone()
}this.removeBox();
this.callback("done",[result])
},removeBox:function(){},activate:function(){if(OpenCharts.Handler.prototype.activate.apply(this,arguments)){this.dragHandler.activate();
return true
}else{return false
}},deactivate:function(){if(OpenCharts.Handler.prototype.deactivate.apply(this,arguments)){this.dragHandler.deactivate();
return true
}else{return false
}},getBoxCharacteristics:function(dx,dy){if(!this.boxCharacteristics){var xOffset=parseInt(OpenCharts.Element.getStyle(this.zoomBox,"border-left-width"))+parseInt(OpenCharts.Element.getStyle(this.zoomBox,"border-right-width"))+1;
var yOffset=parseInt(OpenCharts.Element.getStyle(this.zoomBox,"border-top-width"))+parseInt(OpenCharts.Element.getStyle(this.zoomBox,"border-bottom-width"))+1;
var newBoxModel=OpenCharts.Util.getBrowserName()=="msie"?document.compatMode!="BackCompat":true;
this.boxCharacteristics={xOffset:xOffset,yOffset:yOffset,newBoxModel:newBoxModel}
}return this.boxCharacteristics
},CLASS_NAME:"OpenCharts.Handler.Box"});OpenCharts.Handler.MouseWheel=OpenCharts.Class(OpenCharts.Handler,{wheelListener:null,mousePosition:null,initialize:function(control,callbacks,options){OpenCharts.Handler.prototype.initialize.apply(this,arguments);
this.wheelListener=OpenCharts.Function.bindAsEventListener(this.onWheelEvent,this)
},destroy:function(){OpenCharts.Handler.prototype.destroy.apply(this,arguments);
this.wheelListener=null
},onWheelEvent:function(e){if(!this.map||!this.checkModifiers(e)){return 
}var overScrollableDiv=false;
var overLayerDiv=false;
var overMapDiv=false;
var elem=OpenCharts.Event.element(e);
while((elem!=null)&&!overMapDiv&&!overScrollableDiv){if(!overScrollableDiv){try{if(elem.currentStyle){overflow=elem.currentStyle.overflow
}else{var style=document.defaultView.getComputedStyle(elem,null);
var overflow=style.getPropertyValue("overflow")
}overScrollableDiv=(overflow&&(overflow=="auto")||(overflow=="scroll"))
}catch(err){}}if(!overLayerDiv){for(var i=0,len=this.map.layers.length;
i<len;
i++){if(elem==this.map.layers[i].div||elem==this.map.layers[i].pane){overLayerDiv=true;
break
}}}overMapDiv=(elem==this.map.div);
elem=elem.parentNode
}if(!overScrollableDiv&&overMapDiv){if(overLayerDiv){this.wheelZoom(e)
}OpenCharts.Event.stop(e)
}},wheelZoom:function(e){var delta=0;
if(!e){e=window.event
}if(e.wheelDelta){delta=e.wheelDelta/120;
if(window.opera&&window.opera.version()<9.2){delta=-delta
}}else{if(e.detail){delta=-e.detail/3
}}if(delta){if(this.mousePosition){e.xy=this.mousePosition
}if(!e.xy){e.xy=this.map.getPixelFromLonLat(this.map.getCenter())
}if(delta<0){this.callback("down",[e,delta])
}else{this.callback("up",[e,delta])
}}},mousemove:function(evt){this.mousePosition=evt.xy
},activate:function(evt){if(OpenCharts.Handler.prototype.activate.apply(this,arguments)){var wheelListener=this.wheelListener;
OpenCharts.Event.observe(window,"DOMMouseScroll",wheelListener);
OpenCharts.Event.observe(window,"mousewheel",wheelListener);
OpenCharts.Event.observe(document,"mousewheel",wheelListener);
return true
}else{return false
}},deactivate:function(evt){if(OpenCharts.Handler.prototype.deactivate.apply(this,arguments)){var wheelListener=this.wheelListener;
OpenCharts.Event.stopObserving(window,"DOMMouseScroll",wheelListener);
OpenCharts.Event.stopObserving(window,"mousewheel",wheelListener);
OpenCharts.Event.stopObserving(document,"mousewheel",wheelListener);
return true
}else{return false
}},CLASS_NAME:"OpenCharts.Handler.MouseWheel"});OpenCharts.Handler.Keyboard=OpenCharts.Class(OpenCharts.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,initialize:function(control,callbacks,options){OpenCharts.Handler.prototype.initialize.apply(this,arguments);
this.eventListener=OpenCharts.Function.bindAsEventListener(this.handleKeyEvent,this)
},destroy:function(){this.deactivate();
this.eventListener=null;
OpenCharts.Handler.prototype.destroy.apply(this,arguments)
},activate:function(){if(OpenCharts.Handler.prototype.activate.apply(this,arguments)){for(var i=0,len=this.KEY_EVENTS.length;
i<len;
i++){OpenCharts.Event.observe(document,this.KEY_EVENTS[i],this.eventListener)
}return true
}else{return false
}},deactivate:function(){var deactivated=false;
if(OpenCharts.Handler.prototype.deactivate.apply(this,arguments)){for(var i=0,len=this.KEY_EVENTS.length;
i<len;
i++){OpenCharts.Event.stopObserving(document,this.KEY_EVENTS[i],this.eventListener)
}deactivated=true
}return deactivated
},handleKeyEvent:function(evt){if(this.checkModifiers(evt)){this.callback(evt.type,[evt])
}},CLASS_NAME:"OpenCharts.Handler.Keyboard"});OpenCharts.Control=OpenCharts.Class({id:null,map:null,div:null,type:null,allowSelection:false,displayClass:"",title:"",active:null,handler:null,eventListeners:null,events:null,EVENT_TYPES:["activate","deactivate"],initialize:function(options){this.displayClass=this.CLASS_NAME.replace("OpenCharts.","ol").replace(/\./g,"");
OpenCharts.Util.extend(this,options);
this.events=new OpenCharts.Events(this,null,this.EVENT_TYPES);
if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)
}if(this.id==null){this.id=OpenCharts.Util.createUniqueID(this.CLASS_NAME+"_")
}},destroy:function(){if(this.events){if(this.eventListeners){this.events.un(this.eventListeners)
}this.events.destroy();
this.events=null
}this.eventListeners=null;
if(this.handler){this.handler.destroy();
this.handler=null
}if(this.handlers){for(var key in this.handlers){if(this.handlers.hasOwnProperty(key)&&typeof this.handlers[key].destroy=="function"){this.handlers[key].destroy()
}}this.handlers=null
}if(this.map){this.map.removeControl(this);
this.map=null
}},setMap:function(map){this.map=map;
if(this.handler){this.handler.setMap(map)
}},draw:function(px){if(this.div==null){this.div=OpenCharts.Util.createDiv(this.id);
this.div.className=this.displayClass;
if(!this.allowSelection){this.div.className+=" olControlNoSelect";
this.div.setAttribute("unselectable","on",0);
this.div.onselectstart=function(){return(false)
}
}if(this.title!=""){this.div.title=this.title
}}if(px!=null){this.position=px.clone()
}this.moveTo(this.position);
return this.div
},moveTo:function(px){if((px!=null)&&(this.div!=null)){this.div.style.left=px.x+"px";
this.div.style.top=px.y+"px"
}},activate:function(){if(this.active){return false
}if(this.handler){this.handler.activate()
}this.active=true;
this.events.triggerEvent("activate");
return true
},deactivate:function(){if(this.active){if(this.handler){this.handler.deactivate()
}this.active=false;
this.events.triggerEvent("deactivate");
return true
}return false
},CLASS_NAME:"OpenCharts.Control"});
OpenCharts.Control.TYPE_BUTTON=1;
OpenCharts.Control.TYPE_TOGGLE=2;
OpenCharts.Control.TYPE_TOOL=3;OpenCharts.Geometry=OpenCharts.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenCharts.Util.createUniqueID(this.CLASS_NAME+"_")
},destroy:function(){this.id=null;
this.bounds=null
},clone:function(){return new OpenCharts.Geometry()
},setBounds:function(bounds){if(bounds){this.bounds=bounds.clone()
}},clearBounds:function(){this.bounds=null;
if(this.parent){this.parent.clearBounds()
}},extendBounds:function(newBounds){var bounds=this.getBounds();
if(!bounds){this.setBounds(newBounds)
}else{this.bounds.extend(newBounds)
}},getBounds:function(){if(this.bounds==null){this.calculateBounds()
}return this.bounds
},calculateBounds:function(){},atPoint:function(lonlat,toleranceLon,toleranceLat){var atPoint=false;
var bounds=this.getBounds();
if((bounds!=null)&&(lonlat!=null)){var dX=(toleranceLon!=null)?toleranceLon:0;
var dY=(toleranceLat!=null)?toleranceLat:0;
var toleranceBounds=new OpenCharts.Bounds(this.bounds.left-dX,this.bounds.bottom-dY,this.bounds.right+dX,this.bounds.top+dY);
atPoint=toleranceBounds.containsLonLat(lonlat)
}return atPoint
},getLength:function(){return 0
},getArea:function(){return 0
},toString:function(){return""
},CLASS_NAME:"OpenCharts.Geometry"});
OpenCharts.Geometry.segmentsIntersect=function(seg1,seg2,point){var intersection=false;
var x11_21=seg1.x1-seg2.x1;
var y11_21=seg1.y1-seg2.y1;
var x12_11=seg1.x2-seg1.x1;
var y12_11=seg1.y2-seg1.y1;
var y22_21=seg2.y2-seg2.y1;
var x22_21=seg2.x2-seg2.x1;
var d=(y22_21*x12_11)-(x22_21*y12_11);
var n1=(x22_21*y11_21)-(y22_21*x11_21);
var n2=(x12_11*y11_21)-(y12_11*x11_21);
if(d==0){if(n1==0&&n2==0){intersection=true
}}else{var along1=n1/d;
var along2=n2/d;
if(along1>=0&&along1<=1&&along2>=0&&along2<=1){if(!point){intersection=true
}else{var x=seg1.x1+(along1*x12_11);
var y=seg1.y1+(along1*y12_11);
intersection=new OpenCharts.Geometry.Point(x,y)
}}}return intersection
};OpenCharts.Geometry.Rectangle=OpenCharts.Class(OpenCharts.Geometry,{x:null,y:null,width:null,height:null,initialize:function(x,y,width,height){OpenCharts.Geometry.prototype.initialize.apply(this,arguments);
this.x=x;
this.y=y;
this.width=width;
this.height=height
},calculateBounds:function(){this.bounds=new OpenCharts.Bounds(this.x,this.y,this.x+this.width,this.y+this.height)
},getLength:function(){var length=(2*this.width)+(2*this.height);
return length
},getArea:function(){var area=this.width*this.height;
return area
},CLASS_NAME:"OpenCharts.Geometry.Rectangle"});OpenCharts.Geometry.Point=OpenCharts.Class(OpenCharts.Geometry,{x:null,y:null,initialize:function(x,y){OpenCharts.Geometry.prototype.initialize.apply(this,arguments);
this.x=parseFloat(x);
this.y=parseFloat(y)
},clone:function(obj){if(obj==null){obj=new OpenCharts.Geometry.Point(this.x,this.y)
}OpenCharts.Util.applyDefaults(obj,this);
return obj
},calculateBounds:function(){this.bounds=new OpenCharts.Bounds(this.x,this.y,this.x,this.y)
},distanceTo:function(point){var distance=0;
if((this.x!=null)&&(this.y!=null)&&(point!=null)&&(point.x!=null)&&(point.y!=null)){var dx2=Math.pow(this.x-point.x,2);
var dy2=Math.pow(this.y-point.y,2);
distance=Math.sqrt(dx2+dy2)
}return distance
},equals:function(geom){var equals=false;
if(geom!=null){equals=((this.x==geom.x&&this.y==geom.y)||(isNaN(this.x)&&isNaN(this.y)&&isNaN(geom.x)&&isNaN(geom.y)))
}return equals
},toShortString:function(){return(this.x+", "+this.y)
},move:function(x,y){this.x=this.x+x;
this.y=this.y+y;
this.clearBounds()
},rotate:function(angle,origin){angle*=Math.PI/180;
var radius=this.distanceTo(origin);
var theta=angle+Math.atan2(this.y-origin.y,this.x-origin.x);
this.x=origin.x+(radius*Math.cos(theta));
this.y=origin.y+(radius*Math.sin(theta));
this.clearBounds()
},resize:function(scale,origin,ratio){ratio=(ratio==undefined)?1:ratio;
this.x=origin.x+(scale*ratio*(this.x-origin.x));
this.y=origin.y+(scale*(this.y-origin.y));
this.clearBounds()
},intersects:function(geometry){var intersect=false;
if(geometry.CLASS_NAME=="OpenCharts.Geometry.Point"){intersect=this.equals(geometry)
}else{intersect=geometry.intersects(this)
}return intersect
},transform:function(source,dest){if((source&&dest)){OpenCharts.Projection.transform(this,source,dest);
this.bounds=null
}return this
},CLASS_NAME:"OpenCharts.Geometry.Point"});OpenCharts.Geometry.LineString=OpenCharts.Class(OpenCharts.Geometry.Curve,{initialize:function(points){OpenCharts.Geometry.Curve.prototype.initialize.apply(this,arguments)
},removeComponent:function(point){if(this.components&&(this.components.length>2)){OpenCharts.Geometry.Collection.prototype.removeComponent.apply(this,arguments)
}},intersects:function(geometry){var intersect=false;
var type=geometry.CLASS_NAME;
if(type=="OpenCharts.Geometry.LineString"||type=="OpenCharts.Geometry.LinearRing"||type=="OpenCharts.Geometry.Point"){var segs1=this.getSortedSegments();
var segs2;
if(type=="OpenCharts.Geometry.Point"){segs2=[{x1:geometry.x,y1:geometry.y,x2:geometry.x,y2:geometry.y}]
}else{segs2=geometry.getSortedSegments()
}var seg1,seg1x1,seg1x2,seg1y1,seg1y2,seg2,seg2y1,seg2y2;
outer:for(var i=0,len=segs1.length;
i<len;
++i){seg1=segs1[i];
seg1x1=seg1.x1;
seg1x2=seg1.x2;
seg1y1=seg1.y1;
seg1y2=seg1.y2;
inner:for(var j=0,jlen=segs2.length;
j<jlen;
++j){seg2=segs2[j];
if(seg2.x1>seg1x2){break
}if(seg2.x2<seg1x1){continue
}seg2y1=seg2.y1;
seg2y2=seg2.y2;
if(Math.min(seg2y1,seg2y2)>Math.max(seg1y1,seg1y2)){continue
}if(Math.max(seg2y1,seg2y2)<Math.min(seg1y1,seg1y2)){continue
}if(OpenCharts.Geometry.segmentsIntersect(seg1,seg2)){intersect=true;
break outer
}}}}else{intersect=geometry.intersects(this)
}return intersect
},getSortedSegments:function(){var numSeg=this.components.length-1;
var segments=new Array(numSeg);
for(var i=0;
i<numSeg;
++i){point1=this.components[i];
point2=this.components[i+1];
if(point1.x<point2.x){segments[i]={x1:point1.x,y1:point1.y,x2:point2.x,y2:point2.y}
}else{segments[i]={x1:point2.x,y1:point2.y,x2:point1.x,y2:point1.y}
}}function byX1(seg1,seg2){return seg1.x1-seg2.x1
}return segments.sort(byX1)
},CLASS_NAME:"OpenCharts.Geometry.LineString"});OpenCharts.Geometry.Polygon=OpenCharts.Class(OpenCharts.Geometry.Collection,{componentTypes:["OpenCharts.Geometry.LinearRing"],initialize:function(components){OpenCharts.Geometry.Collection.prototype.initialize.apply(this,arguments)
},getArea:function(){var area=0;
if(this.components&&(this.components.length>0)){area+=Math.abs(this.components[0].getArea());
for(var i=1,len=this.components.length;
i<len;
i++){area-=Math.abs(this.components[i].getArea())
}}return area
},containsPoint:function(point){var numRings=this.components.length;
var contained=false;
if(numRings>0){contained=this.components[0].containsPoint(point);
if(contained!==1){if(contained&&numRings>1){var hole;
for(var i=1;
i<numRings;
++i){hole=this.components[i].containsPoint(point);
if(hole){if(hole===1){contained=1
}else{contained=false
}break
}}}}}return contained
},intersects:function(geometry){var intersect=false;
var i,len;
if(geometry.CLASS_NAME=="OpenCharts.Geometry.Point"){intersect=this.containsPoint(geometry)
}else{if(geometry.CLASS_NAME=="OpenCharts.Geometry.LineString"||geometry.CLASS_NAME=="OpenCharts.Geometry.LinearRing"){for(i=0,len=this.components.length;
i<len;
++i){intersect=geometry.intersects(this.components[i]);
if(intersect){break
}}if(!intersect){for(i=0,len=geometry.components.length;
i<len;
++i){intersect=this.containsPoint(geometry.components[i]);
if(intersect){break
}}}}else{for(i=0,len=geometry.components.length;
i<len;
++i){intersect=this.intersects(geometry.components[i]);
if(intersect){break
}}}}if(!intersect&&geometry.CLASS_NAME=="OpenCharts.Geometry.Polygon"){var ring=this.components[0];
for(i=0,len=ring.components.length;
i<len;
++i){intersect=geometry.containsPoint(ring.components[i]);
if(intersect){break
}}}return intersect
},CLASS_NAME:"OpenCharts.Geometry.Polygon"});
OpenCharts.Geometry.Polygon.createRegularPolygon=function(origin,radius,sides,rotation){var angle=Math.PI*((1/sides)-(1/2));
if(rotation){angle+=(rotation/180)*Math.PI
}var rotatedAngle,x,y;
var points=[];
for(var i=0;
i<sides;
++i){rotatedAngle=angle+(i*2*Math.PI/sides);
x=origin.x+(radius*Math.cos(rotatedAngle));
y=origin.y+(radius*Math.sin(rotatedAngle));
points.push(new OpenCharts.Geometry.Point(x,y))
}var ring=new OpenCharts.Geometry.LinearRing(points);
return new OpenCharts.Geometry.Polygon([ring])
};OpenCharts.Geometry.MultiLineString=OpenCharts.Class(OpenCharts.Geometry.Collection,{componentTypes:["OpenCharts.Geometry.LineString"],initialize:function(components){OpenCharts.Geometry.Collection.prototype.initialize.apply(this,arguments)
},CLASS_NAME:"OpenCharts.Geometry.MultiLineString"});OpenCharts.Geometry.Surface=OpenCharts.Class(OpenCharts.Geometry,{initialize:function(){OpenCharts.Geometry.prototype.initialize.apply(this,arguments)
},CLASS_NAME:"OpenCharts.Geometry.Surface"});OpenCharts.Renderer=OpenCharts.Class({container:null,extent:null,locked:false,size:null,resolution:null,map:null,initialize:function(containerID,options){this.container=OpenCharts.Util.getElement(containerID)
},destroy:function(){this.container=null;
this.extent=null;
this.size=null;
this.resolution=null;
this.map=null
},supported:function(){return false
},setExtent:function(extent,resolutionChanged){this.extent=extent.clone();
if(resolutionChanged){this.resolution=null
}},setSize:function(size){this.size=size.clone();
this.resolution=null
},getResolution:function(){if(this.offset==null&&this.containerId!=null){var tab=document.getElementById(this.containerId).offsets;
this.offset=new OpenCharts.Pixel(Math.abs(tab[0]),Math.abs(tab[1]))
}this.resolution=this.resolution||this.map.getResolution();
return this.resolution
},drawFeature:function(feature,style){if(style==null){style=feature.style
}if(feature.geometry){var bounds=feature.geometry.getBounds();
if(bounds){if(!bounds.intersectsBounds(this.extent)){style={display:"none"}
}return this.drawGeometry(feature.geometry,style,feature.id)
}}},drawGeometry:function(geometry,style,featureId){},clear:function(){},getFeatureIdFromEvent:function(evt){},eraseFeatures:function(features){if(!(features instanceof Array)){features=[features]
}for(var i=0,len=features.length;
i<len;
++i){this.eraseGeometry(features[i].geometry)
}},eraseGeometry:function(geometry){},CLASS_NAME:"OpenCharts.Renderer"});OpenCharts.ElementsIndexer=OpenCharts.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(yOrdering){this.compare=yOrdering?OpenCharts.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenCharts.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;
this.order=[];
this.indices={};
this.maxZIndex=0
},insert:function(newNode){if(this.exists(newNode)){this.remove(newNode)
}var nodeId=newNode.id;
this.determineZIndex(newNode);
var leftIndex=-1;
var rightIndex=this.order.length;
var middle;
while(rightIndex-leftIndex>1){middle=parseInt((leftIndex+rightIndex)/2);
var placement=this.compare(this,newNode,OpenCharts.Util.getElement(this.order[middle]));
if(placement>0){leftIndex=middle
}else{rightIndex=middle
}}this.order.splice(rightIndex,0,nodeId);
this.indices[nodeId]=this.getZIndex(newNode);
var nextIndex=rightIndex+1;
return nextIndex<this.order.length?OpenCharts.Util.getElement(this.order[nextIndex]):null
},remove:function(node){var nodeId=node.id;
var arrayIndex=OpenCharts.Util.indexOf(this.order,nodeId);
if(arrayIndex>=0){this.order.splice(arrayIndex,1);
delete this.indices[nodeId];
if(this.order.length>0){var lastId=this.order[this.order.length-1];
this.maxZIndex=this.indices[lastId]
}else{this.maxZIndex=0
}}},clear:function(){this.order=[];
this.indices={};
this.maxZIndex=0
},exists:function(node){return(this.indices[node.id]!=null)
},getZIndex:function(node){return node._style.graphicZIndex
},determineZIndex:function(node){var zIndex=node._style.graphicZIndex;
if(zIndex==null){zIndex=this.maxZIndex;
node._style.graphicZIndex=zIndex
}else{if(zIndex>this.maxZIndex){this.maxZIndex=zIndex
}}},CLASS_NAME:"OpenCharts.ElementsIndexer"});
OpenCharts.ElementsIndexer.IndexingMethods={Z_ORDER:function(indexer,newNode,nextNode){var newZIndex=indexer.getZIndex(newNode);
var returnVal=0;
if(nextNode){var nextZIndex=indexer.getZIndex(nextNode);
returnVal=newZIndex-nextZIndex
}return returnVal
},Z_ORDER_DRAWING_ORDER:function(indexer,newNode,nextNode){var returnVal=OpenCharts.ElementsIndexer.IndexingMethods.Z_ORDER(indexer,newNode,nextNode);
if(nextNode&&returnVal==0){returnVal=1
}return returnVal
},Z_ORDER_Y_ORDER:function(indexer,newNode,nextNode){var returnVal=OpenCharts.ElementsIndexer.IndexingMethods.Z_ORDER(indexer,newNode,nextNode);
if(nextNode&&returnVal==0){var newLat=newNode._geometry.getBounds().bottom;
var nextLat=nextNode._geometry.getBounds().bottom;
var result=nextLat-newLat;
returnVal=(result==0)?1:result
}return returnVal
}};
OpenCharts.Renderer.Elements=OpenCharts.Class(OpenCharts.Renderer,{rendererRoot:null,root:null,xmlns:null,indexer:null,BACKGROUND_ID_SUFFIX:"_background",minimumSymbolizer:{strokeLinecap:"round",strokeOpacity:1,strokeDashstyle:"solid",fillOpacity:1,pointRadius:0},initialize:function(containerID,options){OpenCharts.Renderer.prototype.initialize.apply(this,arguments);
this.rendererRoot=this.createRenderRoot();
this.root=this.createRoot();
this.rendererRoot.appendChild(this.root);
this.container.appendChild(this.rendererRoot);
if(options&&(options.zIndexing||options.yOrdering)){this.indexer=new OpenCharts.ElementsIndexer(options.yOrdering)
}},destroy:function(){this.clear();
this.rendererRoot=null;
this.root=null;
this.xmlns=null;
OpenCharts.Renderer.prototype.destroy.apply(this,arguments)
},clear:function(){if(this.root){while(this.root.childNodes.length>0){this.root.removeChild(this.root.firstChild)
}}if(this.indexer){this.indexer.clear()
}},getNodeType:function(geometry,style){},drawGeometry:function(geometry,style,featureId){var className=geometry.CLASS_NAME;
var rendered=true;
if((className=="OpenCharts.Geometry.Collection")||(className=="OpenCharts.Geometry.MultiPoint")||(className=="OpenCharts.Geometry.MultiLineString")||(className=="OpenCharts.Geometry.MultiPolygon")){for(var i=0,len=geometry.components.length;
i<len;
i++){rendered=rendered&&this.drawGeometry(geometry.components[i],style,featureId)
}return rendered
}rendered=false;
if(style.display!="none"){if(style.backgroundGraphic){this.redrawBackgroundNode(geometry.id,geometry,style,featureId)
}rendered=this.redrawNode(geometry.id,geometry,style,featureId)
}if(rendered==false){var node=document.getElementById(geometry.id);
if(node){if(node._style.backgroundGraphic){node.parentNode.removeChild(document.getElementById(geometry.id+this.BACKGROUND_ID_SUFFIX))
}node.parentNode.removeChild(node)
}}return rendered
},redrawNode:function(id,geometry,style,featureId){var node=this.nodeFactory(id,this.getNodeType(geometry,style));
node._featureId=featureId;
node._geometry=geometry;
node._geometryClass=geometry.CLASS_NAME;
node._style=style;
var drawResult=this.drawGeometryNode(node,geometry,style);
if(drawResult===false){return false
}node=drawResult.node;
var insert=this.indexer?this.indexer.insert(node):null;
if(insert){this.root.insertBefore(node,insert)
}else{this.root.appendChild(node)
}this.postDraw(node);
return drawResult.complete
},redrawBackgroundNode:function(id,geometry,style,featureId){var backgroundStyle=OpenCharts.Util.extend({},style);
backgroundStyle.externalGraphic=backgroundStyle.backgroundGraphic;
backgroundStyle.graphicXOffset=backgroundStyle.backgroundXOffset;
backgroundStyle.graphicYOffset=backgroundStyle.backgroundYOffset;
backgroundStyle.graphicZIndex=backgroundStyle.backgroundGraphicZIndex;
backgroundStyle.backgroundGraphic=null;
backgroundStyle.backgroundXOffset=null;
backgroundStyle.backgroundYOffset=null;
backgroundStyle.backgroundGraphicZIndex=null;
return this.redrawNode(id+this.BACKGROUND_ID_SUFFIX,geometry,backgroundStyle,null)
},drawGeometryNode:function(node,geometry,style){style=style||node._style;
OpenCharts.Util.applyDefaults(style,this.minimumSymbolizer);
var options={isFilled:true,isStroked:!!style.strokeWidth};
var drawn;
switch(geometry.CLASS_NAME){case"OpenCharts.Geometry.Point":drawn=this.drawPoint(node,geometry);
break;
case"OpenCharts.Geometry.LineString":options.isFilled=false;
drawn=this.drawLineString(node,geometry);
break;
case"OpenCharts.Geometry.LinearRing":drawn=this.drawLinearRing(node,geometry);
break;
case"OpenCharts.Geometry.Polygon":drawn=this.drawPolygon(node,geometry);
break;
case"OpenCharts.Geometry.Surface":drawn=this.drawSurface(node,geometry);
break;
case"OpenCharts.Geometry.Rectangle":drawn=this.drawRectangle(node,geometry);
break;
default:break
}node._style=style;
node._options=options;
if(drawn!=false){return{node:this.setStyle(node,style,options,geometry),complete:drawn}
}else{return false
}},postDraw:function(node){},drawPoint:function(node,geometry){},drawLineString:function(node,geometry){},drawLinearRing:function(node,geometry){},drawPolygon:function(node,geometry){},drawRectangle:function(node,geometry){alert("icila")
},drawCircle:function(node,geometry){},drawSurface:function(node,geometry){},getFeatureIdFromEvent:function(evt){var target=evt.target;
var useElement=target&&target.correspondingUseElement;
var node=useElement?useElement:(target||evt.srcElement);
var featureId=node._featureId;
return featureId
},eraseGeometry:function(geometry){if((geometry.CLASS_NAME=="OpenCharts.Geometry.MultiPoint")||(geometry.CLASS_NAME=="OpenCharts.Geometry.MultiLineString")||(geometry.CLASS_NAME=="OpenCharts.Geometry.MultiPolygon")||(geometry.CLASS_NAME=="OpenCharts.Geometry.Collection")){for(var i=0,len=geometry.components.length;
i<len;
i++){this.eraseGeometry(geometry.components[i])
}}else{var element=OpenCharts.Util.getElement(geometry.id);
if(element&&element.parentNode){if(element.geometry){element.geometry.destroy();
element.geometry=null
}element.parentNode.removeChild(element);
if(this.indexer){this.indexer.remove(element)
}if(element._style.backgroundGraphic){var backgroundId=geometry.id+this.BACKGROUND_ID_SUFFIX;
var bElem=OpenCharts.Util.getElement(backgroundId);
if(bElem&&bElem.parentNode){bElem.parentNode.removeChild(bElem)
}}}}},nodeFactory:function(id,type){var node=OpenCharts.Util.getElement(id);
if(node){if(!this.nodeTypeCompare(node,type)){node.parentNode.removeChild(node);
node=this.nodeFactory(id,type)
}}else{node=this.createNode(type,id)
}return node
},nodeTypeCompare:function(node,type){},createNode:function(type,id){},isComplexSymbol:function(graphicName){return(graphicName!="circle")&&!!graphicName
},CLASS_NAME:"OpenCharts.Renderer.Elements"});
OpenCharts.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]};OpenCharts.Renderer.Elements=OpenCharts.Class(OpenCharts.Renderer.Elements,{initialize:function(containerID,options){OpenCharts.Renderer.prototype.initialize.apply(this,arguments);
if(options&&(options.zIndexing||options.yOrdering)){this.indexer=new OpenCharts.ElementsIndexer(options.yOrdering)
}},assignMapElements:function(){this.map.viewPortDiv=this.map.div;
this.map.layerContainerDiv=this.map.div;
this.map.size=new OpenCharts.Size(this.map.div.getAttribute("width"),this.map.div.getAttribute("height"))
},destroyMapElements:function(){this.map.viewPortDiv=null;
this.map.layerContainerDiv=null;
this.map.size=null
},wheelChange:function(evt,deltaZ){this.map.zoomToPixel(evt.xy,(deltaZ==-1))
},panMapDone:function(xy){this.map.panToPixel(xy)
},zoomBox:function(position){if(position instanceof OpenCharts.Bounds){this.map.zoomToBox(position,this.out)
}else{this.map.zoomToPixel(position,this.out)
}},createBox:function(id,geometry){return this.createRectangle(id,geometry,{fillColor:"#ee9900",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit"},{isFilled:true,isStroked:true})
},createRectangle:function(id,geometry,style,isFilledAndStroked){return this.setStyle(this.nodeFactory(id,this.getNodeType(geometry,null)),style,isFilledAndStroked,null)
}});OpenCharts.Renderer.SVG=OpenCharts.Class(OpenCharts.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15000,translationParameters:null,symbolSize:{},initialize:function(containerID){if(!this.supported()){return 
}OpenCharts.Renderer.Elements.prototype.initialize.apply(this,arguments);
this.translationParameters={x:0,y:0}
},destroy:function(){OpenCharts.Renderer.Elements.prototype.destroy.apply(this,arguments)
},supported:function(){var svgFeature="http://www.w3.org/TR/SVG11/feature#";
return(document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(svgFeature+"SVG","1.1")||document.implementation.hasFeature(svgFeature+"BasicStructure","1.1")))
},inValidRange:function(x,y,xyOnly){var left=x+(xyOnly?0:this.translationParameters.x);
var top=y+(xyOnly?0:this.translationParameters.y);
return(left>=-this.MAX_PIXEL&&left<=this.MAX_PIXEL&&top>=-this.MAX_PIXEL&&top<=this.MAX_PIXEL)
},setExtent:function(extent,resolutionChanged){OpenCharts.Renderer.Elements.prototype.setExtent.apply(this,arguments);
var resolution=this.getResolution();
var left=-extent.left/resolution;
var top=extent.top/resolution;
if(resolutionChanged){this.left=left;
this.top=top;
var extentString="0 0 "+this.size.w+" "+this.size.h;
this.rendererRoot.setAttributeNS(null,"viewBox",extentString);
this.translate(0,0);
return true
}else{var inRange=this.translate(left-this.left,top-this.top);
if(!inRange){this.setExtent(extent,true)
}return inRange
}},translate:function(x,y){if(!this.inValidRange(x,y,true)){return false
}else{var transformString="";
if(x||y){transformString="translate("+x+","+y+")"
}this.root.setAttributeNS(null,"transform",transformString);
this.translationParameters={x:x,y:y};
return true
}},setSize:function(size){OpenCharts.Renderer.prototype.setSize.apply(this,arguments);
this.rendererRoot.setAttributeNS(null,"width",this.size.w);
this.rendererRoot.setAttributeNS(null,"height",this.size.h)
},getNodeType:function(geometry,style){var nodeType=null;
switch(geometry.CLASS_NAME){case"OpenCharts.Geometry.Point":if(style.externalGraphic){nodeType="image"
}else{if(this.isComplexSymbol(style.graphicName)){nodeType="use"
}else{nodeType="circle"
}}break;
case"OpenCharts.Geometry.Rectangle":nodeType="rect";
break;
case"OpenCharts.Geometry.LineString":nodeType="polyline";
break;
case"OpenCharts.Geometry.LinearRing":nodeType="polygon";
break;
case"OpenCharts.Geometry.Polygon":case"OpenCharts.Geometry.Curve":case"OpenCharts.Geometry.Surface":nodeType="path";
break;
default:break
}return nodeType
},setStyle:function(node,style,options){style=style||node._style;
options=options||node._options;
var r=parseFloat(node.getAttributeNS(null,"r"));
var widthFactor=1;
var pos;
if(node._geometryClass=="OpenCharts.Geometry.Point"&&r){if(style.externalGraphic){pos=this.getPosition(node);
if(style.graphicWidth&&style.graphicHeight){node.setAttributeNS(null,"preserveAspectRatio","none")
}var width=style.graphicWidth||style.graphicHeight;
var height=style.graphicHeight||style.graphicWidth;
width=width?width:style.pointRadius*2;
height=height?height:style.pointRadius*2;
var xOffset=(style.graphicXOffset!=undefined)?style.graphicXOffset:-(0.5*width);
var yOffset=(style.graphicYOffset!=undefined)?style.graphicYOffset:-(0.5*height);
var opacity=style.graphicOpacity||style.fillOpacity;
node.setAttributeNS(null,"x",(pos.x+xOffset).toFixed());
node.setAttributeNS(null,"y",(pos.y+yOffset).toFixed());
node.setAttributeNS(null,"width",width);
node.setAttributeNS(null,"height",height);
node.setAttributeNS(this.xlinkns,"href",style.externalGraphic);
node.setAttributeNS(null,"style","opacity: "+opacity)
}else{if(this.isComplexSymbol(style.graphicName)){var offset=style.pointRadius*3;
var size=offset*2;
var id=this.importSymbol(style.graphicName);
var href="#"+id;
pos=this.getPosition(node);
widthFactor=this.symbolSize[id]/size;
if(node.getAttributeNS(this.xlinkns,"href")!=href){node.setAttributeNS(this.xlinkns,"href",href)
}else{if(size!=parseFloat(node.getAttributeNS(null,"width"))){node.style.visibility="hidden";
this.container.scrollLeft=this.container.scrollLeft
}}node.setAttributeNS(null,"width",size);
node.setAttributeNS(null,"height",size);
node.setAttributeNS(null,"x",pos.x-offset);
node.setAttributeNS(null,"y",pos.y-offset);
node.style.visibility=""
}else{node.setAttributeNS(null,"r",style.pointRadius)
}}if(typeof style.rotation!="undefined"&&pos){var rotation=OpenCharts.String.format("rotate(${0} ${1} ${2})",[style.rotation,pos.x,pos.y]);
node.setAttributeNS(null,"transform",rotation)
}}if(options.isFilled){node.setAttributeNS(null,"fill",style.fillColor);
node.setAttributeNS(null,"fill-opacity",style.fillOpacity)
}else{node.setAttributeNS(null,"fill","none")
}if(options.isStroked){node.setAttributeNS(null,"stroke",style.strokeColor);
node.setAttributeNS(null,"stroke-opacity",style.strokeOpacity);
node.setAttributeNS(null,"stroke-width",style.strokeWidth*widthFactor);
node.setAttributeNS(null,"stroke-linecap",style.strokeLinecap);
node.setAttributeNS(null,"stroke-linejoin","round");
node.setAttributeNS(null,"stroke-dasharray",this.dashStyle(style,widthFactor))
}else{node.setAttributeNS(null,"stroke","none")
}if(style.pointerEvents){node.setAttributeNS(null,"pointer-events",style.pointerEvents)
}if(style.cursor!=null){node.setAttributeNS(null,"cursor",style.cursor)
}return node
},dashStyle:function(style,widthFactor){var w=style.strokeWidth*widthFactor;
switch(style.strokeDashstyle){case"solid":return"none";
case"dot":return[1,4*w].join();
case"dash":return[4*w,4*w].join();
case"dashdot":return[4*w,4*w,1,4*w].join();
case"longdash":return[8*w,4*w].join();
case"longdashdot":return[8*w,4*w,1,4*w].join();
default:return style.strokeDashstyle.replace(/ /g,",")
}},createNode:function(type,id){var node=document.createElementNS(this.xmlns,type);
if(id){node.setAttributeNS(null,"id",id)
}return node
},nodeTypeCompare:function(node,type){return(type==node.nodeName)
},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_svgRoot","svg")
},createRoot:function(){return this.nodeFactory(this.container.id+"_root","g")
},createDefs:function(){var defs=this.nodeFactory("ol-renderer-defs","defs");
this.rendererRoot.appendChild(defs);
return defs
},drawPoint:function(node,geometry){return this.drawCircle(node,geometry,1)
},drawCircle:function(node,geometry,radius){var resolution=this.getResolution();
var x=(geometry.x/resolution+this.left);
var y=(this.top-geometry.y/resolution);
if(this.inValidRange(x,y)){node.setAttributeNS(null,"cx",x);
node.setAttributeNS(null,"cy",y);
node.setAttributeNS(null,"r",radius);
return node
}else{return false
}},drawLineString:function(node,geometry){var componentsResult=this.getComponentsString(geometry.components);
if(componentsResult.path){node.setAttributeNS(null,"points",componentsResult.path);
return(componentsResult.complete?node:null)
}else{return false
}},drawLinearRing:function(node,geometry){var componentsResult=this.getComponentsString(geometry.components);
if(componentsResult.path){node.setAttributeNS(null,"points",componentsResult.path);
return(componentsResult.complete?node:null)
}else{return false
}},drawPolygon:function(node,geometry){var d="";
var draw=true;
var complete=true;
var linearRingResult,path;
for(var j=0,len=geometry.components.length;
j<len;
j++){d+=" M";
linearRingResult=this.getComponentsString(geometry.components[j].components," ");
path=linearRingResult.path;
if(path){d+=" "+path;
complete=linearRingResult.complete&&complete
}else{draw=false
}}d+=" z";
if(draw){node.setAttributeNS(null,"d",d);
node.setAttributeNS(null,"fill-rule","evenodd");
return complete?node:null
}else{return false
}},drawRectangle:function(node,geometry){var resolution=this.getResolution();
var x=(geometry.x/resolution);
var y=(geometry.y/resolution);
alert("ici");
if(this.inValidRange(x,y)){node.setAttributeNS(null,"x",x);
node.setAttributeNS(null,"y",y);
node.setAttributeNS(null,"width",geometry.width/resolution);
node.setAttributeNS(null,"height",geometry.height/resolution);
return node
}else{return false
}},drawSurface:function(node,geometry){var d=null;
var draw=true;
for(var i=0,len=geometry.components.length;
i<len;
i++){if((i%3)==0&&(i/3)==0){var component=this.getShortString(geometry.components[i]);
if(!component){draw=false
}d="M "+component
}else{if((i%3)==1){var component=this.getShortString(geometry.components[i]);
if(!component){draw=false
}d+=" C "+component
}else{var component=this.getShortString(geometry.components[i]);
if(!component){draw=false
}d+=" "+component
}}}d+=" Z";
if(draw){node.setAttributeNS(null,"d",d);
return node
}else{return false
}},getComponentsString:function(components,separator){var renderCmp=[];
var complete=true;
var len=components.length;
var strings=[];
var str,component,j;
for(var i=0;
i<len;
i++){component=components[i];
renderCmp.push(component);
str=this.getShortString(component);
if(str){strings.push(str)
}else{if(i>0){if(this.getShortString(components[i-1])){strings.push(this.clipLine(components[i],components[i-1]))
}}if(i<len-1){if(this.getShortString(components[i+1])){strings.push(this.clipLine(components[i],components[i+1]))
}}complete=false
}}return{path:strings.join(separator||","),complete:complete}
},clipLine:function(badComponent,goodComponent){if(goodComponent.equals(badComponent)){return""
}var resolution=this.getResolution();
var maxX=this.MAX_PIXEL-this.translationParameters.x;
var maxY=this.MAX_PIXEL-this.translationParameters.y;
var x1=goodComponent.x/resolution+this.left;
var y1=this.top-goodComponent.y/resolution;
var x2=badComponent.x/resolution+this.left;
var y2=this.top-badComponent.y/resolution;
var k;
if(x2<-maxX||x2>maxX){k=(y2-y1)/(x2-x1);
x2=x2<0?-maxX:maxX;
y2=y1+(x2-x1)*k
}if(y2<-maxY||y2>maxY){k=(x2-x1)/(y2-y1);
y2=y2<0?-maxY:maxY;
x2=x1+(y2-y1)*k
}return x2+","+y2
},getShortString:function(point){var resolution=this.getResolution();
var x=(point.x/resolution+this.left);
var y=(this.top-point.y/resolution);
if(this.inValidRange(x,y)){return x+","+y
}else{return false
}},getPosition:function(node){return({x:parseFloat(node.getAttributeNS(null,"cx")),y:parseFloat(node.getAttributeNS(null,"cy"))})
},importSymbol:function(graphicName){if(!this.defs){this.defs=this.createDefs()
}var id=this.container.id+"-"+graphicName;
if(document.getElementById(id)!=null){return id
}var symbol=OpenCharts.Renderer.symbol[graphicName];
if(!symbol){throw new Error(graphicName+" is not a valid symbol name");
return 
}var symbolNode=this.nodeFactory(id,"symbol");
var node=this.nodeFactory(null,"polygon");
symbolNode.appendChild(node);
var symbolExtent=new OpenCharts.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);
var points="";
var x,y;
for(var i=0;
i<symbol.length;
i=i+2){x=symbol[i];
y=symbol[i+1];
symbolExtent.left=Math.min(symbolExtent.left,x);
symbolExtent.bottom=Math.min(symbolExtent.bottom,y);
symbolExtent.right=Math.max(symbolExtent.right,x);
symbolExtent.top=Math.max(symbolExtent.top,y);
points+=" "+x+","+y
}node.setAttributeNS(null,"points",points);
var width=symbolExtent.getWidth();
var height=symbolExtent.getHeight();
var viewBox=[symbolExtent.left-width,symbolExtent.bottom-height,width*3,height*3];
symbolNode.setAttributeNS(null,"viewBox",viewBox.join(" "));
this.symbolSize[id]=Math.max(width,height)*3;
this.defs.appendChild(symbolNode);
return symbolNode.id
},CLASS_NAME:"OpenCharts.Renderer.SVG"});OpenCharts.Renderer.SVG=OpenCharts.Class(OpenCharts.Renderer.SVG,{inValidRange:function(x,y,xyOnly){return true
},pan:function(dx,dy,options){draggingElement=this.map.div;
var p=document.documentElement.createSVGPoint();
p.x=0;
p.y=0;
p=p.matrixTransform(OpenCharts.Util.getScreenCTM().inverse());
p.x-=(dx-parseFloat(this.map.div.getAttribute("x")));
p.y-=(dy-parseFloat(this.map.div.getAttribute("y")));
draggingElement.setAttribute("x",p.x);
draggingElement.setAttribute("y",p.y);
draggingElement.setAttribute("transform","translate("+p.x+","+p.y+")")
},zoomTo:function(out,parameters){var parameters={"org.mapfaces.chart.CONTAINER_SIZE":this.map.div.getAttribute("width")+","+this.map.div.getAttribute("height"),"org.mapfaces.chart.ZOOMIN":(!out),"org.mapfaces.chart.ZOOMOUT":out};
this.map.sendAjaxRequest(parameters)
},zoomToBox:function(bounds,out){var parameters={"org.mapfaces.chart.BOX":bounds.left+","+bounds.top+","+bounds.right+","+bounds.bottom,"org.mapfaces.chart.CONTAINER_SIZE":this.map.div.getAttribute("width")+","+this.map.div.getAttribute("height"),"org.mapfaces.chart.ZOOMIN":(!out),"org.mapfaces.chart.ZOOMOUT":out};
this.map.sendAjaxRequest(parameters)
},zoomToPixel:function(pixel,out){var parameters={"org.mapfaces.chart.PIXEL":pixel.x+","+pixel.y,"org.mapfaces.chart.CONTAINER_SIZE":this.map.div.getAttribute("width")+","+this.map.div.getAttribute("height"),"org.mapfaces.chart.ZOOMIN":(!out),"org.mapfaces.chart.ZOOMOUT":out};
this.map.sendAjaxRequest(parameters)
},panToPixel:function(pixel){var parameters={"org.mapfaces.chart.OFFSET":this.map.canvasContainer.getAttribute("x")+","+this.map.canvasContainer.getAttribute("y"),"org.mapfaces.chart.TRANSLATE":this.map.div.getAttribute("x")+","+this.map.div.getAttribute("y"),"org.mapfaces.chart.CONTAINER_SIZE":this.map.canvasContainer.getAttribute("width")+","+this.map.canvasContainer.getAttribute("height"),"org.mapfaces.chart.PAN":true};
this.map.sendAjaxRequest(parameters)
},drawRectangle:function(node,geometry){node.setAttributeNS(null,"x",geometry.x);
node.setAttributeNS(null,"y",geometry.y);
node.setAttributeNS(null,"width",geometry.width);
node.setAttributeNS(null,"height",geometry.height);
return node
},createText:function(text,x,y,attributes){var elt=this.nodeFactory("","text");
elt.appendChild(document.createTextNode(text));
elt.setAttribute("x",x);
elt.setAttribute("y",y);
for(var i in attributes){elt.setAttribute(i,attributes[i])
}return elt
},createBubble:function(elt,x,y,width,height,style){var textAttributes={fill:"black"};
var geometry=new OpenCharts.Geometry.Rectangle(x,y,width,height);
var rect=this.drawRectangle(this.setStyle(this.nodeFactory("",this.getNodeType(geometry,null)),style,{isFilled:true,isStroked:true},null),geometry);
rect.setAttribute("rx",10);
rect.setAttribute("ry",10);
var g=this.nodeFactory("bubble","g");
g.appendChild(rect);
g.appendChild(this.createText("Serie : "+elt.getAttribute("serie"),x+10,y+20,textAttributes));
var date=new Date();
date.setTime(parseFloat(elt.getAttribute("xValue")));
g.appendChild(this.createText("   Date  : "+date.toGMTString(),x+10,y+40,textAttributes));
g.appendChild(this.createText("   Value : "+elt.getAttribute("yValue"),x+10,y+60,textAttributes));
g.setAttribute("text-rendering","geometricPrecision");
g.setAttribute("font-family","Arial");
g.setAttribute("font-size","11px");
g.setAttribute("style","display:block;");
return g
},getAttribute:function(attrName,node){if(attrName=="strokeColor"){return node.getAttribute("stroke")
}return parseFloat(node.getAttribute(attrName))
},addEvents:function(node,events){if(events&&node&&(node.nodeName=="path"||node.nodeName=="circle")){for(var i in events){node.addEventListener(i,events[i],false)
}}}});OpenCharts.Renderer.Canvas=OpenCharts.Class(OpenCharts.Renderer,{root:null,canvas:null,features:null,geometryMap:null,initialize:function(containerID){OpenCharts.Renderer.prototype.initialize.apply(this,arguments);
this.root=document.createElement("canvas");
this.container.appendChild(this.root);
this.canvas=this.root.getContext("2d");
this.features={};
this.geometryMap={}
},eraseGeometry:function(geometry){this.eraseFeatures(this.features[this.geometryMap[geometry.id]][0])
},supported:function(){var canvas=document.createElement("canvas");
return !!canvas.getContext
},setExtent:function(extent){this.extent=extent.clone();
this.resolution=null;
this.redraw()
},setSize:function(size){this.size=size.clone();
this.root.style.width=size.w+"px";
this.root.style.height=size.h+"px";
this.root.width=size.w;
this.root.height=size.h;
this.resolution=null
},drawFeature:function(feature,style){if(style==null){style=feature.style
}style=OpenCharts.Util.extend({fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1},style);
this.features[feature.id]=[feature,style];
this.geometryMap[feature.geometry.id]=feature.id;
this.redraw()
},drawGeometry:function(geometry,style){var className=geometry.CLASS_NAME;
if((className=="OpenCharts.Geometry.Collection")||(className=="OpenCharts.Geometry.MultiPoint")||(className=="OpenCharts.Geometry.MultiLineString")||(className=="OpenCharts.Geometry.MultiPolygon")){for(var i=0;
i<geometry.components.length;
i++){this.drawGeometry(geometry.components[i],style)
}return 
}switch(geometry.CLASS_NAME){case"OpenCharts.Geometry.Point":this.drawPoint(geometry,style);
break;
case"OpenCharts.Geometry.LineString":this.drawLineString(geometry,style);
break;
case"OpenCharts.Geometry.LinearRing":this.drawLinearRing(geometry,style);
break;
case"OpenCharts.Geometry.Polygon":this.drawPolygon(geometry,style);
break;
default:break
}},drawExternalGraphic:function(pt,style){var img=new Image();
img.src=style.externalGraphic;
var width=style.graphicWidth||style.graphicHeight;
var height=style.graphicHeight||style.graphicWidth;
width=width?width:style.pointRadius*2;
height=height?height:style.pointRadius*2;
var xOffset=(style.graphicXOffset!=undefined)?style.graphicXOffset:-(0.5*width);
var yOffset=(style.graphicYOffset!=undefined)?style.graphicYOffset:-(0.5*height);
var opacity=style.graphicOpacity||style.fillOpacity;
var context={img:img,x:(pt[0]+xOffset),y:(pt[1]+yOffset),width:width,height:height,canvas:this.canvas};
img.onload=OpenCharts.Function.bind(function(){this.canvas.drawImage(this.img,this.x,this.y,this.width,this.height)
},context)
},setCanvasStyle:function(type,style){if(type=="fill"){this.canvas.globalAlpha=style.fillOpacity;
this.canvas.fillStyle=style.fillColor
}else{if(type=="stroke"){this.canvas.globalAlpha=style.strokeOpacity;
this.canvas.strokeStyle=style.strokeColor;
this.canvas.lineWidth=style.strokeWidth
}else{this.canvas.globalAlpha=0;
this.canvas.lineWidth=1
}}},drawPoint:function(geometry,style){var pt=this.getLocalXY(geometry);
if(style.externalGraphic){this.drawExternalGraphic(pt,style)
}else{this.setCanvasStyle("fill",style);
this.canvas.beginPath();
this.canvas.arc(pt[0],pt[1],6,0,Math.PI*2,true);
this.canvas.fill();
this.setCanvasStyle("stroke",style);
this.canvas.beginPath();
this.canvas.arc(pt[0],pt[1],6,0,Math.PI*2,true);
this.canvas.stroke();
this.setCanvasStyle("reset")
}},drawLineString:function(geometry,style){this.setCanvasStyle("stroke",style);
this.canvas.beginPath();
var start=this.getLocalXY(geometry.components[0]);
this.canvas.moveTo(start[0],start[1]);
for(var i=1;
i<geometry.components.length;
i++){var pt=this.getLocalXY(geometry.components[i]);
this.canvas.lineTo(pt[0],pt[1])
}this.canvas.stroke();
this.setCanvasStyle("reset")
},drawLinearRing:function(geometry,style){this.setCanvasStyle("fill",style);
this.canvas.beginPath();
var start=this.getLocalXY(geometry.components[0]);
this.canvas.moveTo(start[0],start[1]);
for(var i=1;
i<geometry.components.length-1;
i++){var pt=this.getLocalXY(geometry.components[i]);
this.canvas.lineTo(pt[0],pt[1])
}this.canvas.fill();
var oldWidth=this.canvas.lineWidth;
this.setCanvasStyle("stroke",style);
this.canvas.beginPath();
var start=this.getLocalXY(geometry.components[0]);
this.canvas.moveTo(start[0],start[1]);
for(var i=1;
i<geometry.components.length;
i++){var pt=this.getLocalXY(geometry.components[i]);
this.canvas.lineTo(pt[0],pt[1])
}this.canvas.stroke();
this.setCanvasStyle("reset")
},drawPolygon:function(geometry,style){this.drawLinearRing(geometry.components[0],style);
for(var i=1;
i<geometry.components.length;
i++){this.drawLinearRing(geometry.components[i],{fillOpacity:0,strokeWidth:0,strokeOpacity:0,strokeColor:"#000000",fillColor:"#000000"})
}},getLocalXY:function(point){var resolution=this.getResolution();
var extent=this.extent;
var x=(point.x/resolution+(-extent.left/resolution));
var y=((extent.top/resolution)-point.y/resolution);
return[x,y]
},clear:function(){this.canvas.clearRect(0,0,this.root.width,this.root.height)
},getFeatureIdFromEvent:function(evt){var loc=this.map.getLonLatFromPixel(evt.xy);
var resolution=this.getResolution();
var bounds=new OpenCharts.Bounds(loc.lon-resolution*5,loc.lat-resolution*5,loc.lon+resolution*5,loc.lat+resolution*5);
var geom=bounds.toGeometry();
for(var feat in this.features){if(!this.features.hasOwnProperty(feat)){continue
}if(this.features[feat][0].geometry.intersects(geom)){return feat
}}return null
},eraseFeatures:function(features){if(!(features instanceof Array)){features=[features]
}for(var i=0;
i<features.length;
++i){delete this.features[features[i].id]
}this.redraw()
},redraw:function(){if(!this.locked){this.clear();
for(var id in this.features){if(!this.features.hasOwnProperty(id)){continue
}if(!this.features[id][0].geometry){continue
}this.drawGeometry(this.features[id][0].geometry,this.features[id][1])
}}},CLASS_NAME:"OpenCharts.Renderer.Canvas"});OpenCharts.Renderer.VML=OpenCharts.Class(OpenCharts.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(containerID){if(!this.supported()){return 
}if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);
var style=document.createStyleSheet();
style.addRule("olv\\:*","behavior: url(#default#VML); position: absolute; display: inline-block;")
}OpenCharts.Renderer.Elements.prototype.initialize.apply(this,arguments);
this.offset={x:0,y:0}
},destroy:function(){OpenCharts.Renderer.Elements.prototype.destroy.apply(this,arguments)
},supported:function(){return !!(document.namespaces)
},setExtent:function(extent,resolutionChanged){OpenCharts.Renderer.Elements.prototype.setExtent.apply(this,arguments);
var resolution=this.getResolution();
var left=extent.left/resolution;
var top=extent.top/resolution-this.size.h;
if(resolutionChanged){this.offset={x:left,y:top};
left=0;
top=0
}else{left=left-this.offset.x;
top=top-this.offset.y
}var org=left+" "+top;
this.root.setAttribute("coordorigin",org);
var size=this.size.w+" "+this.size.h;
this.root.setAttribute("coordsize",size);
this.root.style.flip="y";
return true
},setSize:function(size){OpenCharts.Renderer.prototype.setSize.apply(this,arguments);
this.rendererRoot.style.width=this.size.w+"px";
this.rendererRoot.style.height=this.size.h+"px";
this.root.style.width=this.size.w+"px";
this.root.style.height=this.size.h+"px"
},getNodeType:function(geometry,style){var nodeType=null;
switch(geometry.CLASS_NAME){case"OpenCharts.Geometry.Point":if(style.externalGraphic){nodeType="olv:rect"
}else{if(this.isComplexSymbol(style.graphicName)){nodeType="olv:shape"
}else{nodeType="olv:oval"
}}break;
case"OpenCharts.Geometry.Rectangle":nodeType="olv:rect";
break;
case"OpenCharts.Geometry.LineString":case"OpenCharts.Geometry.LinearRing":case"OpenCharts.Geometry.Polygon":case"OpenCharts.Geometry.Curve":case"OpenCharts.Geometry.Surface":nodeType="olv:shape";
break;
default:break
}return nodeType
},setStyle:function(node,style,options,geometry){style=style||node._style;
options=options||node._options;
var widthFactor=1;
if(node._geometryClass=="OpenCharts.Geometry.Point"){if(style.externalGraphic){var width=style.graphicWidth||style.graphicHeight;
var height=style.graphicHeight||style.graphicWidth;
width=width?width:style.pointRadius*2;
height=height?height:style.pointRadius*2;
var resolution=this.getResolution();
var xOffset=(style.graphicXOffset!=undefined)?style.graphicXOffset:-(0.5*width);
var yOffset=(style.graphicYOffset!=undefined)?style.graphicYOffset:-(0.5*height);
node.style.left=((geometry.x/resolution-this.offset.x)+xOffset).toFixed();
node.style.top=((geometry.y/resolution-this.offset.y)-(yOffset+height)).toFixed();
node.style.width=width+"px";
node.style.height=height+"px";
node.style.flip="y";
style.fillColor="none";
options.isStroked=false
}else{if(this.isComplexSymbol(style.graphicName)){var cache=this.importSymbol(style.graphicName);
var symbolExtent=cache.extent;
var width=symbolExtent.getWidth();
var height=symbolExtent.getHeight();
node.setAttribute("path",cache.path);
node.setAttribute("coordorigin",symbolExtent.left+","+symbolExtent.bottom);
node.setAttribute("coordsize",width+","+height);
node.style.left=symbolExtent.left+"px";
node.style.top=symbolExtent.bottom+"px";
node.style.width=width+"px";
node.style.height=height+"px";
this.drawCircle(node,geometry,style.pointRadius);
node.style.flip="y"
}else{this.drawCircle(node,geometry,style.pointRadius)
}}}if(options.isFilled){node.setAttribute("fillcolor",style.fillColor)
}else{node.setAttribute("filled","false")
}var fills=node.getElementsByTagName("fill");
var fill=(fills.length==0)?null:fills[0];
if(!options.isFilled){if(fill){node.removeChild(fill)
}}else{if(!fill){fill=this.createNode("olv:fill",node.id+"_fill")
}fill.setAttribute("opacity",style.fillOpacity);
if(node._geometryClass=="OpenCharts.Geometry.Point"&&style.externalGraphic){if(style.graphicOpacity){fill.setAttribute("opacity",style.graphicOpacity)
}fill.setAttribute("src",style.externalGraphic);
fill.setAttribute("type","frame");
if(!(style.graphicWidth&&style.graphicHeight)){fill.aspect="atmost"
}}if(fill.parentNode!=node){node.appendChild(fill)
}}if(typeof style.rotation!="undefined"){if(style.externalGraphic){this.graphicRotate(node,xOffset,yOffset);
fill.setAttribute("opacity",0)
}else{node.style.rotation=style.rotation
}}if(options.isStroked){node.setAttribute("strokecolor",style.strokeColor);
node.setAttribute("strokeweight",style.strokeWidth+"px")
}else{node.setAttribute("stroked","false")
}var strokes=node.getElementsByTagName("stroke");
var stroke=(strokes.length==0)?null:strokes[0];
if(!options.isStroked){if(stroke){node.removeChild(stroke)
}}else{if(!stroke){stroke=this.createNode("olv:stroke",node.id+"_stroke");
node.appendChild(stroke)
}stroke.setAttribute("opacity",style.strokeOpacity);
stroke.setAttribute("endcap",!style.strokeLinecap||style.strokeLinecap=="butt"?"flat":style.strokeLinecap);
stroke.setAttribute("dashstyle",this.dashStyle(style))
}if(style.cursor!="inherit"&&style.cursor!=null){node.style.cursor=style.cursor
}return node
},graphicRotate:function(node,xOffset,yOffset){var style=style||node._style;
var options=node._options;
var aspectRatio,size;
if(!(style.graphicWidth&&style.graphicHeight)){var img=new Image();
img.onreadystatechange=OpenCharts.Function.bind(function(){if(img.readyState=="complete"||img.readyState=="interactive"){aspectRatio=img.width/img.height;
size=Math.max(style.pointRadius*2,style.graphicWidth||0,style.graphicHeight||0);
xOffset=xOffset*aspectRatio;
style.graphicWidth=size*aspectRatio;
style.graphicHeight=size;
this.graphicRotate(node,xOffset,yOffset)
}},this);
img.src=style.externalGraphic;
return 
}else{size=Math.max(style.graphicWidth,style.graphicHeight);
aspectRatio=style.graphicWidth/style.graphicHeight
}var width=Math.round(style.graphicWidth||size*aspectRatio);
var height=Math.round(style.graphicHeight||size);
node.style.width=width+"px";
node.style.height=height+"px";
var image=document.getElementById(node.id+"_image");
if(!image){image=this.createNode("olv:imagedata",node.id+"_image");
node.appendChild(image)
}image.style.width=width+"px";
image.style.height=height+"px";
image.src=style.externalGraphic;
image.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";
var rotation=style.rotation*Math.PI/180;
var sintheta=Math.sin(rotation);
var costheta=Math.cos(rotation);
var filter="progid:DXImageTransform.Microsoft.Matrix(M11="+costheta+",M12="+(-sintheta)+",M21="+sintheta+",M22="+costheta+",SizingMethod='auto expand')\n";
var opacity=style.graphicOpacity||style.fillOpacity;
if(opacity&&opacity!=1){filter+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+opacity+")\n"
}node.style.filter=filter;
var centerPoint=new OpenCharts.Geometry.Point(-xOffset,-yOffset);
var imgBox=new OpenCharts.Bounds(0,0,width,height).toGeometry();
imgBox.rotate(style.rotation,centerPoint);
var imgBounds=imgBox.getBounds();
node.style.left=Math.round(parseInt(node.style.left)+imgBounds.left)+"px";
node.style.top=Math.round(parseInt(node.style.top)-imgBounds.bottom)+"px"
},postDraw:function(node){var fillColor=node._style.fillColor;
var strokeColor=node._style.strokeColor;
if(fillColor=="none"&&node.getAttribute("fillcolor")!=fillColor){node.setAttribute("fillcolor",fillColor)
}if(strokeColor=="none"&&node.getAttribute("strokecolor")!=strokeColor){node.setAttribute("strokecolor",strokeColor)
}},setNodeDimension:function(node,geometry){var bbox=geometry.getBounds();
if(bbox){var resolution=this.getResolution();
var scaledBox=new OpenCharts.Bounds((bbox.left/resolution-this.offset.x).toFixed(),(bbox.bottom/resolution-this.offset.y).toFixed(),(bbox.right/resolution-this.offset.x).toFixed(),(bbox.top/resolution-this.offset.y).toFixed());
node.style.left=scaledBox.left+"px";
node.style.top=scaledBox.top+"px";
node.style.width=scaledBox.getWidth()+"px";
node.style.height=scaledBox.getHeight()+"px";
node.coordorigin=scaledBox.left+" "+scaledBox.top;
node.coordsize=scaledBox.getWidth()+" "+scaledBox.getHeight()
}},dashStyle:function(style){var dash=style.strokeDashstyle;
switch(dash){case"solid":case"dot":case"dash":case"dashdot":case"longdash":case"longdashdot":return dash;
default:var parts=dash.split(/[ ,]/);
if(parts.length==2){if(1*parts[0]>=2*parts[1]){return"longdash"
}return(parts[0]==1||parts[1]==1)?"dot":"dash"
}else{if(parts.length==4){return(1*parts[0]>=2*parts[1])?"longdashdot":"dashdot"
}}return"solid"
}},createNode:function(type,id){var node=document.createElement(type);
if(id){node.setAttribute("id",id)
}node.setAttribute("unselectable","on",0);
node.onselectstart=function(){return(false)
};
return node
},nodeTypeCompare:function(node,type){var subType=type;
var splitIndex=subType.indexOf(":");
if(splitIndex!=-1){subType=subType.substr(splitIndex+1)
}var nodeName=node.nodeName;
splitIndex=nodeName.indexOf(":");
if(splitIndex!=-1){nodeName=nodeName.substr(splitIndex+1)
}return(subType==nodeName)
},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")
},createRoot:function(){return this.nodeFactory(this.container.id+"_root","olv:group")
},drawPoint:function(node,geometry){return this.drawCircle(node,geometry,1)
},drawCircle:function(node,geometry,radius){if(!isNaN(geometry.x)&&!isNaN(geometry.y)){var resolution=this.getResolution();
node.style.left=((geometry.x/resolution-this.offset.x).toFixed()-radius)+"px";
node.style.top=((geometry.y/resolution-this.offset.y).toFixed()-radius)+"px";
var diameter=radius*2;
node.style.width=diameter+"px";
node.style.height=diameter+"px";
return node
}return false
},drawLineString:function(node,geometry){return this.drawLine(node,geometry,false)
},drawLinearRing:function(node,geometry){return this.drawLine(node,geometry,true)
},drawLine:function(node,geometry,closeLine){this.setNodeDimension(node,geometry);
var resolution=this.getResolution();
var numComponents=geometry.components.length;
var parts=new Array(numComponents);
var comp,x,y;
for(var i=0;
i<numComponents;
i++){comp=geometry.components[i];
x=(comp.x/resolution-this.offset.x);
y=(comp.y/resolution-this.offset.y);
parts[i]=" "+x.toFixed()+","+y.toFixed()+" l "
}var end=(closeLine)?" x e":" e";
node.path="m"+parts.join("")+end;
return node
},drawPolygon:function(node,geometry){this.setNodeDimension(node,geometry);
var resolution=this.getResolution();
var path=[];
var linearRing,i,j,len,ilen,comp,x,y;
for(j=0,len=geometry.components.length;
j<len;
j++){linearRing=geometry.components[j];
path.push("m");
for(i=0,ilen=linearRing.components.length;
i<ilen;
i++){comp=linearRing.components[i];
x=comp.x/resolution-this.offset.x;
y=comp.y/resolution-this.offset.y;
path.push(" "+x.toFixed()+","+y.toFixed());
if(i==0){path.push(" l")
}}path.push(" x ")
}path.push("e");
node.path=path.join("");
return node
},drawRectangle:function(node,geometry){var resolution=this.getResolution();
node.style.left=(geometry.x-this.offset.x)+"px";
node.style.top=(geometry.y-this.offset.y)+"px";
node.style.width=geometry.width+"px";
node.style.height=geometry.height+"px";
return node
},drawSurface:function(node,geometry){this.setNodeDimension(node,geometry);
var resolution=this.getResolution();
var path=[];
var comp,x,y;
for(var i=0,len=geometry.components.length;
i<len;
i++){comp=geometry.components[i];
x=comp.x/resolution-this.offset.x;
y=comp.y/resolution-this.offset.y;
if((i%3)==0&&(i/3)==0){path.push("m")
}else{if((i%3)==1){path.push(" c")
}}path.push(" "+x+","+y)
}path.push(" x e");
node.path=path.join("");
return node
},importSymbol:function(graphicName){var id=this.container.id+"-"+graphicName;
var cache=this.symbolCache[id];
if(cache){return cache
}var symbol=OpenCharts.Renderer.symbol[graphicName];
if(!symbol){throw new Error(graphicName+" is not a valid symbol name");
return 
}var symbolExtent=new OpenCharts.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);
var pathitems=["m"];
for(var i=0;
i<symbol.length;
i=i+2){x=symbol[i];
y=symbol[i+1];
symbolExtent.left=Math.min(symbolExtent.left,x);
symbolExtent.bottom=Math.min(symbolExtent.bottom,y);
symbolExtent.right=Math.max(symbolExtent.right,x);
symbolExtent.top=Math.max(symbolExtent.top,y);
pathitems.push(x);
pathitems.push(y);
if(i==0){pathitems.push("l")
}}pathitems.push("x e");
var path=pathitems.join(" ");
cache={path:path,extent:symbolExtent};
this.symbolCache[id]=cache;
return cache
},CLASS_NAME:"OpenCharts.Renderer.VML"});OpenCharts.Renderer.VML=OpenCharts.Class(OpenCharts.Renderer.VML,{resolution:1,calculOffset:function(elt){if(!elt.scrolls){elt.scrolls=[];
elt.scrolls[0]=(document.documentElement.scrollLeft||document.body.scrollLeft);
elt.scrolls[1]=(document.documentElement.scrollTop||document.body.scrollTop)
}if(!elt.lefttop){elt.lefttop=[];
elt.lefttop[0]=(document.documentElement.clientLeft||0);
elt.lefttop[1]=(document.documentElement.clientTop||0)
}if(!elt.offsets){elt.offsets=OpenCharts.Util.pagePosition(elt);
elt.offsets[0]+=elt.scrolls[0];
elt.offsets[1]+=elt.scrolls[1]
}return new OpenCharts.Pixel(elt.offsets[0],elt.offsets[1])
},initialize:function(containerID){if(!this.supported()){return 
}OpenCharts.Renderer.Elements.prototype.initialize.apply(this,arguments);
if((typeof containerID)=="string"){this.containerId=containerID
}else{this.containerId=containerID.id
}this.offset=null
},pan:function(dx,dy,options){var p=new OpenCharts.Pixel((parseFloat(this.map.div.style.left)-dx),(parseFloat(this.map.div.style.top)-dy));
this.map.div.style.left=p.x;
this.map.div.style.top=p.y
},wheelChange:function(evt,deltaZ){var resolution=this.getResolution();
evt.xy.x-=this.offset.x;
evt.xy.y-=this.offset.y;
this.map.zoomToPixel(evt.xy,(deltaZ==-1))
},zoomToBox:function(bounds,out){bounds.left-=this.offset.x;
bounds.top-=this.offset.y;
bounds.right-=this.offset.x;
bounds.bottom-=this.offset.y;
var parameters={"org.mapfaces.chart.BOX":bounds.left+","+bounds.top+","+bounds.right+","+bounds.bottom,"org.mapfaces.chart.CONTAINER_SIZE":parseFloat(this.map.div.style.width)+","+parseFloat(this.map.div.style.height),"org.mapfaces.chart.ZOOMIN":(!out),"org.mapfaces.chart.ZOOMOUT":out};
this.map.sendAjaxRequest(parameters)
},zoomToPixel:function(pixel,out){var parameters={"org.mapfaces.chart.PIXEL":pixel.x+","+pixel.y,"org.mapfaces.chart.CONTAINER_SIZE":parseFloat(this.map.div.style.width)+","+parseFloat(this.map.div.style.height),"org.mapfaces.chart.ZOOMIN":(!out),"org.mapfaces.chart.ZOOMOUT":out};
this.map.sendAjaxRequest(parameters)
},panToPixel:function(pixel){var parameters={"org.mapfaces.chart.OFFSET":parseFloat(this.map.canvasContainer.style.left)+","+parseFloat(this.map.canvasContainer.style.top),"org.mapfaces.chart.TRANSLATE":parseFloat(this.map.div.style.left)+","+parseFloat(this.map.div.style.top),"org.mapfaces.chart.CONTAINER_SIZE":parseFloat(this.map.canvasContainer.style.width)+","+parseFloat(this.map.canvasContainer.style.height),"org.mapfaces.chart.PAN":true};
this.map.sendAjaxRequest(parameters)
},getNodeType:function(geometry,style){var nodeType=null;
switch(geometry.CLASS_NAME){case"OpenCharts.Geometry.Point":if(style.externalGraphic){nodeType="v:rect"
}else{if(this.isComplexSymbol(style.graphicName)){nodeType="v:shape"
}else{nodeType="v:oval"
}}break;
case"OpenCharts.Geometry.Rectangle":nodeType="v:rect";
break;
case"OpenCharts.Geometry.LineString":case"OpenCharts.Geometry.LinearRing":case"OpenCharts.Geometry.Polygon":case"OpenCharts.Geometry.Curve":case"OpenCharts.Geometry.Surface":nodeType="v:shape";
break;
default:break
}return nodeType
},setStyle:function(node,style,options,geometry){style=style||node._style;
options=options||node._options;
var widthFactor=1;
if(node._geometryClass=="OpenCharts.Geometry.Point"){if(style.externalGraphic){var width=style.graphicWidth||style.graphicHeight;
var height=style.graphicHeight||style.graphicWidth;
width=width?width:style.pointRadius*2;
height=height?height:style.pointRadius*2;
var resolution=this.getResolution();
var xOffset=(style.graphicXOffset!=undefined)?style.graphicXOffset:-(0.5*width);
var yOffset=(style.graphicYOffset!=undefined)?style.graphicYOffset:-(0.5*height);
node.style.left=((geometry.x/resolution-this.offset.x)+xOffset).toFixed();
node.style.top=((geometry.y/resolution-this.offset.y)-(yOffset+height)).toFixed();
node.style.width=width+"px";
node.style.height=height+"px";
node.style.flip="y";
style.fillColor="none";
options.isStroked=false
}else{if(this.isComplexSymbol(style.graphicName)){var cache=this.importSymbol(style.graphicName);
var symbolExtent=cache.extent;
var width=symbolExtent.getWidth();
var height=symbolExtent.getHeight();
node.setAttribute("path",cache.path);
node.setAttribute("coordorigin",symbolExtent.left+","+symbolExtent.bottom);
node.setAttribute("coordsize",width+","+height);
node.style.left=symbolExtent.left+"px";
node.style.top=symbolExtent.bottom+"px";
node.style.width=width+"px";
node.style.height=height+"px";
this.drawCircle(node,geometry,style.pointRadius);
node.style.flip="y"
}else{this.drawCircle(node,geometry,style.pointRadius)
}}}if(options.isFilled){node.setAttribute("fillcolor",style.fillColor)
}else{node.setAttribute("filled","false")
}var fills=node.getElementsByTagName("fill");
var fill=(fills.length==0)?null:fills[0];
if(!options.isFilled){if(fill){node.removeChild(fill)
}}else{if(!fill){fill=this.createNode("v:fill",node.id+"_fill")
}fill.setAttribute("opacity",style.fillOpacity);
if(node._geometryClass=="OpenCharts.Geometry.Point"&&style.externalGraphic){if(style.graphicOpacity){fill.setAttribute("opacity",style.graphicOpacity)
}fill.setAttribute("src",style.externalGraphic);
fill.setAttribute("type","frame");
if(!(style.graphicWidth&&style.graphicHeight)){fill.aspect="atmost"
}}if(fill.parentNode!=node){node.appendChild(fill)
}}if(typeof style.rotation!="undefined"){if(style.externalGraphic){this.graphicRotate(node,xOffset,yOffset);
fill.setAttribute("opacity",0)
}else{node.style.rotation=style.rotation
}}if(options.isStroked){node.setAttribute("strokecolor",style.strokeColor);
node.setAttribute("strokeweight",style.strokeWidth+"px")
}else{node.setAttribute("stroked","false")
}var strokes=node.getElementsByTagName("stroke");
var stroke=(strokes.length==0)?null:strokes[0];
if(!options.isStroked){if(stroke){node.removeChild(stroke)
}}else{if(!stroke){stroke=this.createNode("v:stroke",node.id+"_stroke");
node.appendChild(stroke)
}stroke.setAttribute("opacity",style.strokeOpacity);
stroke.setAttribute("endcap",!style.strokeLinecap||style.strokeLinecap=="butt"?"flat":style.strokeLinecap);
stroke.setAttribute("dashstyle",this.dashStyle(style))
}if(style.cursor!="inherit"&&style.cursor!=null){node.style.cursor=style.cursor
}return node
},setAttr:function(node,attr){for(var i in attr){node.setAttribute(i,attr[i])
}return node
},createNodeWithAttr:function(type,attr){return this.setAttr(this.nodeFactory("",type),attr)
},createRoundrectNode:function(attr){return this.createNodeWithAttr("v:roundrect",attr)
},createRoundrect:function(attr,style,options){return this.setStyle(this.createRoundrectNode(attr),style,options,null)
},createShapeNode:function(attr){return this.createNodeWithAttr("v:shape",attr)
},createShape:function(attr,style,options){return this.setStyle(this.createShapeNode(attr),style,options,null)
},createPathNode:function(attr){return this.createNodeWithAttr("v:path",attr)
},createTextpathNode:function(attr){return this.createNodeWithAttr("v:textpath",attr)
},createTextboxNode:function(attr){return this.createNodeWithAttr("v:textbox",attr)
},createTextbox:function(html){var elt=this.createTextboxNode();
elt.innerHTML=html;
return elt
},createBubble:function(elt,x,y,width,height,style,offset){if(offset){x+=offset.x;
y+=offset.y
}var geometry=new OpenCharts.Geometry.Rectangle(x,y,width,height);
var rect=this.drawRectangle(this.createRoundrect({id:"bubble",arcsize:0.2},style,{isFilled:true,isStroked:true}),geometry);
var date=new Date();
date.setTime(parseFloat(elt.getAttribute("xValue")));
var htmlContent="Serie : "+elt.getAttribute("serie")+"<br/>    Date : "+date+"<br/>    Value : "+elt.getAttribute("yValue")+"<br/>";
rect.appendChild(this.createTextbox(htmlContent));
rect.style.fontSize="11px";
rect.style.fontFamily="Arial";
return rect
},getAttribute:function(attrName,node){if(attrName=="x"){return parseFloat(node.style.left)
}else{if(attrName=="y"){return parseFloat(node.style.top)
}else{if(attrName=="width"){return parseFloat(node.style.width)
}else{if(attrName=="height"){return parseFloat(node.style.height)
}else{if(attrName=="strokeColor"){return node.getAttribute("strokecolor")
}else{return"none"
}}}}}},addEvents:function(node,events){if(events&&node&&(node.nodeName=="shape"||node.nodeName=="oval")){for(var i in events){node.attachEvent("on"+i,events[i],false)
}}}});OpenCharts.Handler.MouseWheel=OpenCharts.Class(OpenCharts.Handler,{wheelListener:null,mousePosition:null,initialize:function(control,callbacks,options){OpenCharts.Handler.prototype.initialize.apply(this,arguments);
this.wheelListener=OpenCharts.Function.bindAsEventListener(this.onWheelEvent,this)
},destroy:function(){OpenCharts.Handler.prototype.destroy.apply(this,arguments);
this.wheelListener=null
},onWheelEvent:function(e){if(!this.map||!this.checkModifiers(e)){return 
}var overScrollableDiv=false;
var overLayerDiv=false;
var overMapDiv=false;
var elem=OpenCharts.Event.element(e);
while((elem!=null)&&!overMapDiv&&!overScrollableDiv){if(!overScrollableDiv){try{if(elem.currentStyle){overflow=elem.currentStyle.overflow
}else{var style=document.defaultView.getComputedStyle(elem,null);
var overflow=style.getPropertyValue("overflow")
}overScrollableDiv=(overflow&&(overflow=="auto")||(overflow=="scroll"))
}catch(err){}}if(!overLayerDiv){var layerImgs=this.map.div.getElementsByTagName("img");
if(layerImgs){for(var i=0;
i<layerImgs.length;
i++){if(layerImgs[i].className=="layerImg"&&elem==layerImgs[i]){overLayerDiv=true;
break
}}}}overMapDiv=(elem==this.map.div);
elem=elem.parentNode
}if(!overScrollableDiv&&overMapDiv){if((this.map.renderer.CLASS_NAME=="OpenCharts.Renderer.HTML"&&overLayerDiv)||this.map.renderer.CLASS_NAME=="OpenCharts.Renderer.SVG"||this.map.renderer.CLASS_NAME=="OpenCharts.Renderer.VML"){this.wheelZoom(e)
}OpenCharts.Event.stop(e)
}},wheelZoom:function(e){var delta=0;
if(!e){e=window.event
}if(e.wheelDelta){delta=e.wheelDelta/120;
if(window.opera&&window.opera.version()<9.2){delta=-delta
}}else{if(e.detail){delta=-e.detail/3
}}if(delta){if(this.mousePosition){e.xy=this.mousePosition
}if(!e.xy){e.xy=this.map.getPixelFromLonLat(this.map.getCenter())
}if(delta<0){this.callback("down",[e,delta])
}else{this.callback("up",[e,delta])
}}},mousemove:function(evt){this.mousePosition=evt.xy
},activate:function(evt){if(OpenCharts.Handler.prototype.activate.apply(this,arguments)){var wheelListener=this.wheelListener;
OpenCharts.Event.observe(window,"DOMMouseScroll",wheelListener);
OpenCharts.Event.observe(window,"mousewheel",wheelListener);
OpenCharts.Event.observe(document,"mousewheel",wheelListener);
return true
}else{return false
}},deactivate:function(evt){if(OpenCharts.Handler.prototype.deactivate.apply(this,arguments)){var wheelListener=this.wheelListener;
OpenCharts.Event.stopObserving(window,"DOMMouseScroll",wheelListener);
OpenCharts.Event.stopObserving(window,"mousewheel",wheelListener);
OpenCharts.Event.stopObserving(document,"mousewheel",wheelListener);
return true
}else{return false
}},CLASS_NAME:"OpenCharts.Handler.MouseWheel"});OpenCharts.Control.DragPan=OpenCharts.Class(OpenCharts.Control,{type:OpenCharts.Control.TYPE_TOOL,panned:false,interval:25,draw:function(){this.handler=new OpenCharts.Handler.Drag(this,{move:this.panMap,done:this.panMapDone},{interval:this.interval})
},panMap:function(xy){this.panned=true;
this.map.pan(this.handler.last.x-xy.x,this.handler.last.y-xy.y,{dragging:this.handler.dragging,animate:false})
},panMapDone:function(xy){if(this.panned){this.map.renderer.panMapDone(xy);
this.panned=false
}},CLASS_NAME:"OpenCharts.Control.DragPan"});OpenCharts.Control.ZoomBox=OpenCharts.Class(OpenCharts.Control,{type:OpenCharts.Control.TYPE_TOOL,out:false,draw:function(){this.handler=new OpenCharts.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})
},zoomBox:function(position){this.map.renderer.zoomBox(position)
},CLASS_NAME:"OpenCharts.Control.ZoomBox"});OpenCharts.Control.Navigation=OpenCharts.Class(OpenCharts.Control,{dragPan:null,dragPanOptions:null,zoomBox:null,zoomWheelEnabled:true,handleRightClicks:true,initialize:function(options){this.handlers={};
OpenCharts.Control.prototype.initialize.apply(this,arguments)
},destroy:function(){this.deactivate();
if(this.dragPan){this.dragPan.destroy()
}this.dragPan=null;
if(this.zoomBox){this.zoomBox.destroy()
}this.zoomBox=null;
OpenCharts.Control.prototype.destroy.apply(this,arguments)
},activate:function(){this.dragPan.activate();
if(this.zoomWheelEnabled){this.handlers.wheel.activate()
}this.handlers.click.activate();
this.zoomBox.activate();
return OpenCharts.Control.prototype.activate.apply(this,arguments)
},deactivate:function(){this.zoomBox.deactivate();
this.dragPan.deactivate();
this.handlers.click.deactivate();
this.handlers.wheel.deactivate();
return OpenCharts.Control.prototype.deactivate.apply(this,arguments)
},draw:function(){if(this.handleRightClicks){this.map.div.oncontextmenu=function(){return false
}
}var clickCallbacks={dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick};
var clickOptions={"double":true,stopDouble:true};
this.handlers.click=new OpenCharts.Handler.Click(this,clickCallbacks,clickOptions);
this.dragPan=new OpenCharts.Control.DragPan(OpenCharts.Util.extend({map:this.map},this.dragPanOptions));
this.zoomBox=new OpenCharts.Control.ZoomBox({map:this.map,keyMask:OpenCharts.Handler.MOD_SHIFT});
this.dragPan.draw();
this.zoomBox.draw();
this.handlers.wheel=new OpenCharts.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown});
this.activate()
},defaultDblClick:function(evt){var newCenter=this.map.getLonLatFromViewPortPx(evt.xy);
this.map.setCenter(newCenter,this.map.zoom+1)
},defaultDblRightClick:function(evt){var newCenter=this.map.getLonLatFromViewPortPx(evt.xy);
this.map.setCenter(newCenter,this.map.zoom-1)
},wheelChange:function(evt,deltaZ){this.map.renderer.wheelChange(evt,deltaZ)
},wheelUp:function(evt){this.wheelChange(evt,1)
},wheelDown:function(evt){this.wheelChange(evt,-1)
},disableZoomWheel:function(){this.zoomWheelEnabled=false;
this.handlers.wheel.deactivate()
},enableZoomWheel:function(){this.zoomWheelEnabled=true;
if(this.active){this.handlers.wheel.activate()
}},CLASS_NAME:"OpenCharts.Control.Navigation"});function calculBubblePosition(evt){var x=evt.clientX;
var y=evt.clientY;
var bottom=false;
var left=false;
var position={x:(x+10),y:(y-bubble.size.height-10)};
var canvasContainerElt=document.getElementById("canvasContainer");
if(canvasContainerElt){var minX=window.renderer.getAttribute("x",canvasContainerElt);
var maxX=minX+window.renderer.getAttribute("width",canvasContainerElt);
var minY=window.renderer.getAttribute("y",canvasContainerElt);
bottom=((y-bubble.size.height)<minY)?true:false;
left=((x+bubble.size.width)>maxX)?true:false
}if(bottom){position.y=y+10
}if(left){position.x=x-bubble.size.width-10
}return position
}function addBubble(evt){var position=calculBubblePosition(evt);
var elt=OpenCharts.Event.element(evt);
elt.parentNode.appendChild(window.renderer.createBubble(elt,position.x,position.y,bubble.size.width,bubble.size.height,{fillColor:"white",fillOpacity:1,strokeColor:renderer.getAttribute("strokeColor",elt),strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid"},window.renderer.offset))
}function highlight(evt){var elt=OpenCharts.Event.element(evt);
elt.style.zIndex=elt.style.zIndex-elt.style.zIndex;
window.renderer.setStyle(elt,{strokeColor:renderer.getAttribute("strokeColor",elt),strokeOpacity:1,strokeWidth:6,strokeLinecap:"round",strokeDashstyle:"solid",cursor:"pointer"},{isFilled:false,isStroked:true},new OpenCharts.Geometry.Surface());
addBubble(evt)
}function unhighlight(evt){var elt=OpenCharts.Event.element(evt);
window.renderer.setStyle(elt,{strokeColor:renderer.getAttribute("strokeColor",elt),strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",cursor:"pointer"},{isFilled:false,isStroked:true},new OpenCharts.Geometry.Surface());
if(document.getElementById("bubble")){elt.parentNode.removeChild(document.getElementById("bubble"))
}};var bubble={size:{width:220,height:75},events:{mouseover:highlight,mouseout:unhighlight}};
var defaultColor="black";
function addEvents(id,renderer,events){var elt=document.getElementById(id);
if(elt&&elt.hasChildNodes()&&elt.childNodes.length>0){var list=elt.childNodes;
for(var i=1;
i<list.length;
i++){renderer.addEvents(list[i],events)
}}}function createChart(id){document.chart=new OpenCharts.Map(id,{canvasContainer:document.getElementById(id+"Container")})
}function init(){var id="canvas";
if(document.getElementById(id)){if(window.OpenCharts&&document.getElementById(id+"Container")&&window.createChart){createChart(id);
window.renderer=document.chart.renderer;
if(window.addEvents){addEvents(id,window.renderer,window.bubble.events)
}}}}init();